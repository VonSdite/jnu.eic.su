function debug(){return!1}function errmsg(){debug()||alert("AJAX通信错误,请与管理员联系")}function GetObjById(a){return document.getElementById(a)}function GetId(a){a=a||event;var b=a.srcElement||a.target;return b.id}function ajaxcheck(){try{if(debug())throw"ajax";var a={chstr:"中文"};if("中文"!=a.chstr)throw alert("与服务器通信错误,请联系你的系统管理员"),"ajax error"}catch(b){return console.log("ajaxcheck:"+b),errmsg(),!0}}function CheckLegalStr(a){a.toLowerCase();var b=/select|update|delete|exec|count|'|"|=|;|>|<|%/i;return b.test(a)?!1:!0}function Get_Time(){function d(a,b){return 12*a.year+a.month>12*b.year+b.month?!0:!1}function e(a){var c,b=new Array;for(c=0;c<a.length;++c)0==function(a){for(var c=0;c<b.length;c++)if(b[c].year==a)return!0;return!1}(a[c].year)&&b.push({year:a[c].year,arrMonth:function(){var d,b=new Array;for(d=0;d<a.length;d++)a[d].year==a[c].year&&b.push(a[d].month);return b}()});return b}var a,c,g;try{if(debug())throw"ajax";$.ajax({url:URL+"/sendTime",data:{year:year,month:month},async:!1,dataType:"json",type:"POST",success:function(b){a=b}}),c=a,console.log(c)}catch(b){c={evaluation:[{year:"2014",month:"4"},{year:"2014",month:"5"},{year:"2014",month:"12"},{year:"2014",month:"1"},{year:"2014",month:"2"},{year:"2014",month:"3"},{year:"2013",month:"12"},{year:"2013",month:"6"},{year:"2013",month:"8"},{year:"2012",month:"3"},{year:"2012",month:"5"}],feedback:[{year:"2014",month:"4"},{year:"2011",month:"4"},{year:"2014",month:"5"}],control:[{year:"2014",month:"4"},{year:"2010",month:"4"},{year:"2010",month:"2"},{year:"2014",month:"5"}],excellent:[{year:"2014",month:"4"},{year:"2015",month:"1"},{year:"2014",month:"5"}]},errmsg()}console.log(c);try{c.evaluation.sort(d)}catch(f){c.evaluation=new Array}try{c.feedback.sort(d)}catch(f){c.feedback=new Array}try{c.control.sort(d)}catch(f){c.control=new Array}try{c.excellent.sort(d)}catch(f){c.excellent=new Array}return g={evaluation:e(c.evaluation),feedback:e(c.feedback),control:e(c.control),excellent:e(c.excellent)},console.log(g),g}function TranStr_Post(a){return a=a.toString().replace(new RegExp("([\n])","g"),"&hh&"),a=a.toString().replace(new RegExp(" ","g"),"&kg&")}function TranStr_Get(a){return a=a.toString().replace(new RegExp("&hh&","g"),"\n"),a=a.toString().replace(new RegExp("&kg&","g")," ")}function TranTextToDig(a){arrDepartName.indexOf(a)}function TranDigToText(a){var b=new Array("秘书处","人力资源部","宣传部","信息编辑部","学术部","体育部","KSC联盟","组织部","文娱部","公关部","心理服务部","主席团"),c=b[a-1];return c}function GetTable(){var a,b,d,e,f,g,h,i,j,k;try{if(debug())throw"ajax";$.ajax({url:URL+"/funcqqlx",data:{year:year,month:month},async:!1,dataType:"json",type:"POST",success:function(b){a=b}}),b=a}catch(c){b={account:"2012052308",type:"YBGS",weiji:[{table:"0"},{table:"1"},{table:"2"},{table:"3"},{table:"4"},{table:"5"}]},errmsg()}for(d=new Array("干事自评表","干事考核反馈表","跟进部门出勤统计表","调研意见采纳表","整体考核结果反馈表","部长自评表","干事考核表","部长反馈表","部长考核表","部门考核表","优秀部长评定表","主席团反馈表","考核进程控制表","其他情况加减分","优秀评定限制表","查看未完成情况"),e=new Array("干事自评表","干事考核反馈表"),f=new Array("干事自评表","跟进部门出勤统计表","其他情况加减分","调研意见采纳表","干事考核反馈表","整体考核结果反馈表"),g=new Array("查看未完成情况","优秀评定限制表","部长自评表","干事考核表","整体考核结果反馈表","部长反馈表","考核进程控制表"),h=new Array("部长自评表","干事考核表","部长反馈表","整体考核结果反馈表"),i=new Array("部长考核表","部门考核表","优秀部长评定表","整体考核结果反馈表","主席团反馈表"),j=new Array,k=0;k<b.weiji.length;++k)j.push(arrWeiJiBiao[b.weiji[k].table]);if(debug())return d.concat(j);switch(b.type){case"BZJ":return h.concat(j);case"YBGS":return e.concat(j);case"RLGS":return f.concat(j);case"ZXT":return i.concat(j);case"RLBZ":return g.concat(j)}}function PerformInit(){ajaxcheck(),AutoHideHead(),afxTimeInfo=Get_Time();var a=GetTable();$("#table_name").html(a[0]),ActiveTableButton(),SelectTime(0)}function AutoHideHead(){function e(){function e(){var a;return window.pageYOffset?a=window.pageYOffset:document.compatMode&&"BackCompat"!=document.compatMode?a=document.documentElement.scrollTop:document.body&&(a=document.body.scrollTop),a}function f(){return e()<GetObjById("perform_hdr").offsetTop?(GetObjById("hdr").style.top="0px",void 0):(0>b?(b+=2,GetObjById("hdr").style.top=b+"px",setTimeout(f,5)):GetObjById("hdr").style.top="0px",void 0)}function g(){return a>-134&&(a-=2,GetObjById("hdr").style.top=a+"px",setTimeout(g,5)),e()<GetObjById("perform_hdr").offsetTop?(GetObjById("hdr").style.top="0px",void 0):void 0}document.onmouseover=function(h){function i(){e()>=GetObjById("perform_hdr").offsetTop?"0px"==GetObjById("hdr").style.top&&d>140&&1==c&&(a=0,g()):GetObjById("hdr").style.top="0px"}d=h.clientY,window.onscroll=function(){e()>=GetObjById("perform_hdr").offsetTop?"0px"==GetObjById("hdr").style.top&&d>140&&(a=0,setTimeout(g,1e3)):GetObjById("hdr").style.top="0px"},setTimeout(i,2e3),e()>=GetObjById("perform_hdr").offsetTop?"-134px"==GetObjById("hdr").style.top&&6>=d&&(b=parseInt(GetObjById("hdr").style.top),f()):GetObjById("hdr").style.top="0px"}}var a=0,b=0,c=1,d=0;GetObjById("hdr").style.top="0px",setTimeout(e,500)}function ActiveTableButton(){var c,d,e,f,g,a=GetTable(),b="";for(c=0;c<a.length;++c)d="button_"+c,b+='<button type="button" class="perf_ctrl_button" id="'+d+'" value="'+a[c]+'">'+a[c]+"</button>\n";for(b+='<img id="zhibiao" src='+imgURL+"zhibiao2.png />",GetObjById("control_group").innerHTML=b,e=0,f=0,GetObjById("button_"+f).style.background="#018f89",g=0;g<a.length;++g)d="button_"+g,document.getElementById(d).onclick=function(a){d=GetId(a);var b=d.split("_");e=f,f=parseInt(b[1]),ChangStyle(e,f),SelectTime(f),GetObjById("show_more").innerHTML=""}}function ChangStyle(a,b){GetObjById("button_"+a).style.background="#79c0be",ZhiBiaoHuaDong(a,b),GetObjById("button_"+b).style.background="#018f89";var c=GetTable();GetObjById("table_name").innerHTML=c[b]}function ZhiBiaoHuaDong(a,b){function e(){var a=d/10;Math.abs(d)>=1?(c+=a,GetObjById("zhibiao").style.top=c+"px",d-=a,setTimeout(e,5)):(c+=d,GetObjById("zhibiao").style.top=c+"px")}var c=43+105*a,d=105*(b-a);0!=d&&e()}function SelectTime(a){function d(a){switch(a){case"干事自评表":case"跟进部门出勤统计表":case"调研意见采纳表":case"部长自评表":case"干事考核表":case"部长考核表":case"部门考核表":case"优秀评定限制表":case"其他情况加减分":case"秘书处制度违纪登记表":case"人力资源部制度违纪登记表":case"宣传部制度违纪登记表":case"信息编辑部制度违纪登记表":case"公关部制度违纪登记表":case"司仪礼仪队违纪登记表":return"evaluation";case"主席团反馈表":case"部长反馈表":case"整体考核结果反馈表":case"干事考核反馈表":return"feedback";case"考核进程控制表":case"查看未完成情况":return"control";case"优秀部长评定表":return"excellent"}}var g,b=GetTable(),c=b[a],e=d(c),f=afxTimeInfo[e];for($("#year").html(""),$("#month").html(""),g=0;g<f.length;g++)$("<option></option>",{value:f[g].year,text:f[g].year}).appendTo($("#year"));try{for($("#year").val(f[0].year),g=0;g<f[0].arrMonth.length;g++)$("<option></option>",{value:f[0].arrMonth[g],text:f[0].arrMonth[g]}).appendTo($("#month"));try{$("#month").val(f[0].arrMonth[0])}catch(h){console.log("默认月份设置出错,请注意!")}}catch(i){console.log("默认年份出错,请注意!")}$("#year").change(function(){var a,b;for($("#month").html(""),a=$(this).prop("selectedIndex"),b=0;b<f[a].arrMonth.length;b++)$("<option></option>",{value:f[a].arrMonth[b],text:f[a].arrMonth[b]}).appendTo($("#month"));try{$("#month").val(f[a].arrMonth[0])}catch(c){console.log("默认月份设置出错,请注意!")}}),$("#OK_button").get()[0].onclick=function(){year=$("#year").val(),month=$("#month").val();var b=ArrShowTable();console.log("执行第"+a+"个函数"),b[a]()}}function ArrShowTable(){var c,a=GetTable(),b=new Array;for(c=0;c<a.length;++c)switch(a[c]){case"干事自评表":b.push(Show_GSZP);break;case"干事考核反馈表":b.push(Show_GSKHFK);break;case"跟进部门出勤统计表":b.push(Show_GJBMCQTJ);break;case"调研意见采纳表":b.push(Show_DYYJCN);break;case"整体考核结果反馈表":b.push(Show_ZTKHJGFK);break;case"部长自评表":b.push(Show_BZZP);break;case"干事考核表":b.push(Show_GSKH);break;case"部长反馈表":b.push(Show_BZFK);break;case"部长考核表":b.push(Show_BZKH);break;case"部门考核表":b.push(Show_BMKH);break;case"优秀部长评定表":b.push(Show_YXBZPD);break;case"主席团反馈表":b.push(Show_ZXTFK);break;case"考核进程控制表":b.push(Show_KHJCKZ);break;case"其他情况加减分":b.push(Show_QTQKJJF);break;case"优秀评定限制表":b.push(Show_YXPDXZ);break;case"查看未完成情况":b.push(Show_CKWWCQK);case"秘书处制度违纪登记表":b.push(function(){Show_WJDJ(0)});break;case"人力资源部制度违纪登记表":b.push(function(){Show_WJDJ(1)});break;case"宣传部制度违纪登记表":b.push(function(){Show_WJDJ(2)});break;case"信息编辑部制度违纪登记表":b.push(function(){Show_WJDJ(3)});break;case"公关部制度违纪登记表":b.push(function(){Show_WJDJ(4)});break;case"司仪礼仪队违纪登记表":b.push(function(){Show_WJDJ(5)})}return b}function GSZP_BZ(){function a(){function a(){function a(){this.bz="工作效率",this.a="9-10.总能提早截止日期较多完成安排下去的任务",this.b="7-8.能够按时完成安排下去的任务，踩着时间点完成",this.c="5-6.要超时才能完成安排下去的任务",this.d="3-4.无法完成安排下去的任务"}function b(){this.bz="工作知识",this.a="9-10.部长级讲过工作知识后各方面均能掌握，极为优秀",this.b="7-8.部长级讲过工作知识后对工作了解较充分，能够理解，运用起来有点生疏",this.c="5-6.部长级讲过工作知识后仍对工作不太了解，需要不断询问和他人不断提醒",this.d="3-4.部长级讲过工作知识后对与工作有关的事情有很多都不了解，也不去询问"}function c(){this.bz="应变处理能力",this.a="9-10.遇到情况总能随机应变,首先想办法自己解决，不会立刻求助他人",this.b="7-8.遇到情况一般先求助于他人，偶尔才自己想办法解决",this.c="5-6.遇到情况总是首先求助于他人，不会自己想应变方法，但勉强能解决事情",this.d="3-4.遇到情况不会随机应变，也不问其他人，总把事情搞砸"}this.xm="工作能力",this.rowspan=14,this.arrObj=new Array(new a,new b,new c)}function b(){function a(){this.bz="积极性",this.a="9-10.主动向部长级要求工作，对工作充满热情",this.b="7-8.能够接受部长级布置的任务，并有办好的愿望",this.c="5-6.能够接受部长级安排的任务，但缺乏积极性，办事有点拖拉",this.d="3-4.不领会部长级的安排的任务，需要部长级不断催促"}function b(){this.bz="责任感",this.a="9-10.对布置的工作能够极其认真的完成，犯错误能自觉主动对自己的行为及后果负责",this.b="7-8.布置的任务能够完成，犯错在部长级监督下能对自己的行为后果负责",this.c="5-6.布置的任务不一定能负责的完成，对于工作中的失误有时逃避或推卸责任",this.d="3-4.布置的任务敷衍不负责，对于工作中的失误总是逃避或推卸责任"}function c(){this.bz="纪律性",this.a="9-10.有良好的纪律意识，严格规范自身，不随意违反其他部门制度，工作作风比较严谨",this.b="7-8.能履行职责，大体上能遵守各项规章制度，不服从命令的事少有发生",this.c="5-6.偶尔会发生不守纪律的事情，但部长提醒后能够改正",this.d="3-4.经常发生不守纪律的事，再三提醒下还会出现问题"}this.xm="工作态度",this.rowspan=14,this.arrObj=new Array(new a,new b,new c)}function c(){function a(){this.bz="合作能力",this.a="9-10.能够很好的与他人合作，能提出自己想法，发挥自己的作用，也能接受他人意见",this.b="7-8.愿意与他人合作，但合作中能够相处愉快，但不太主动",this.c="5-6.仅在必要时才与人合作，偶尔会有摩擦，勉强接受与自己不一致的意见",this.d="3-4.排斥与他人合作，十分难以相处"}function b(){this.bz="表达能力",this.a="9-10.能够清晰地表达自己的观点，让别人乐于聆听和理解自己的想法",this.b="7-8.能够表达自己的观点，但需要其他人稍作提示",this.c="5-6.表达自己的观点时存在有人听不懂请求解释的情况，但能解释清楚",this.d="3-4.表达自己观点时太含糊，别人完全听不懂，解释自己的观点时也不够清楚"}function c(){this.bz="团队精神",this.a="9-10.爱护团体，有强烈的团队精神，部门内有活动总是热情参与，也常协助其他同事",this.b="7-8.比较爱护团体，能参与部门活动但偶尔会缺席，与其他同事感情良好",this.c="5-6.团队精神欠缺，偶尔不愿意与部门一起活动，才与部门内其他成员沟通少",this.d="3-4.脱离群众，排斥与部门一起活动，更愿意单独行动，必要时才与他人沟通"}this.xm="沟通能力",this.rowspan=14,this.arrObj=new Array(new a,new b,new c)}this.arrObj_GSZP=new Array(new a,new b,new c)}var b=new a;return b}function Get_GSZP(){function b(){function g(a){this.name=a.name,this.account=a.account}function h(){this.tygs=c.TYGS.tygs,this.account=c.TYGS.account,this.tyly=TranStr_Get(c.TYGS.tyly)}function i(a,b,c,d){this.name=a,this.account=b,this.fs=c,this.pj=TranStr_Get(d)}var b,c,e,f;this.objGSZP_BZ=a;try{if(debug())throw"ajax";$.ajax({url:URL+"/funcgszp",data:{year:year,month:month},async:!1,dataType:"json",type:"POST",success:function(a){b=a}}),console.log("获取干事自评表数据:\n"),console.log(b),c=b}catch(d){c={status:0,DF:[{df:9},{df:9},{df:9},{df:9},{df:9},{df:9},{df:9},{df:9},{df:9},{df:9},{df:9},{df:9},{df:9},{df:9}],zongfen:0,zwpj:"感觉良好",TongShi:[{name:"同事A",account:2012052210},{name:"同事C",account:2012052211},{name:"同事B",account:2012052212},{name:"同事D",account:2012052213}],TYGS:{tygs:"同事C",account:2012052211,tyly:"理由是.....我勒个去"},DBZPJ:[{name:"部长",account:2012052211,fs:9,pj:"评价"}],bumenliuyan:"这个部门还是撤了吧- -",arrTongshiliuyan:[{account:2012052210,liuyan:"我喜欢你"},{account:2012052211,liuyan:"- -"}]},errmsg()}for(this.status=c.status,this.arrDF=new Array,e=0;e<this.objGSZP_BZ.arrObj_GSZP.length;++e)for(this.arrDF[e]=new Array,f=0;f<this.objGSZP_BZ.arrObj_GSZP[e].arrObj.length;++f)this.arrDF[e][f]=c.DF[3*e+f].df;for(this.zongfen=c.zongfen,this.zwpj=TranStr_Get(c.zwpj),this.bumenliuyan=TranStr_Get(c.bumenliuyan),this.arrTongshiliuyan=new Array,e=0;e<c.arrTongshiliuyan.length;e++)this.arrTongshiliuyan[e]=c.arrTongshiliuyan[e],this.arrTongshiliuyan[e].liuyan=TranStr_Get(c.arrTongshiliuyan[e].liuyan);for(""==this.zwpj&&(this.zwpj="请填写....."),this.arrTongShi=new Array,e=0;e<c.TongShi.length;++e)this.arrTongShi.push(new g(c.TongShi[e]));for(this.TYGS=new h,this.arrDBZPJ=new Array,e=0;e<c.DBZPJ.length;++e)this.arrDBZPJ.push(new i(c.DBZPJ[e].name,c.DBZPJ[e].account,c.DBZPJ[e].fs,c.DBZPJ[e].pj))}var a=GSZP_BZ(),c=new b;return c}function Post_GSZP(a){var c,d,e,f,g,h,i,b=new Array;for(c=0;c<a.objGSZP_BZ.arrObj_GSZP.length;++c)for(d=0;d<a.objGSZP_BZ.arrObj_GSZP[c].arrObj.length;++d)b.push({df:a.arrDF[c][d]});for(e=new Array,c=0;c<a.arrTongShi.length;++c)e.push({name:a.arrTongShi[c].name,account:a.arrTongShi[c].account});for(f=new Array,c=0;c<a.arrDBZPJ.length;++c)f.push({name:a.arrDBZPJ[c].name,account:a.arrDBZPJ[c].account,fs:a.arrDBZPJ[c].fs,pj:TranStr_Post(a.arrDBZPJ[c].pj)});for(g=new Array,c=0;c<a.arrTongshiliuyan.length;c++)strLiuyanTemp=a.arrTongshiliuyan[c].liuyan,""!=strLiuyanTemp&&" "!=strLiuyanTemp&&"无"!=strLiuyanTemp&&g.push({account:a.arrTongshiliuyan[c].account,liuyan:TranStr_Post(strLiuyanTemp)});h={year:year,month:month,status:a.status,arrDF:b,zongfen:a.zongfen,zwpj:TranStr_Post(a.zwpj),arrTongShi:e,arrTongshiliuyan:g,bumenliuyan:TranStr_Post(a.bumenliuyan),TYGS:{tygs:a.TYGS.tygs,account:a.TYGS.account,tyly:TranStr_Post(a.TYGS.tyly)},arrDBZPJ:f,hadSubmit:a.hadSubmit},console.log(h);try{return debug()?!0:($.ajax({url:URL+"/post_gszp",data:h,async:!1,dataType:"json",type:"POST",success:function(a){i=a}}),i.flagCrud?!0:!1)}catch(j){console.log(j)}}function Get_GSKHFK(){function a(){var a,b,d,e;try{if(debug())throw"ajax";$.ajax({url:URL+"/jsgskh",data:{year:year,month:month},async:!1,dataType:"json",type:"POST",success:function(b){a=b}}),b=a}catch(c){b={zongfen:"100",paiming:"1",yxgs:"朱林杰",bmpm:1,bmdf:1024,DFXJ:[{a:2,b:4,c:8,d:16,e:32,f:64,g:128}],zwpj:"自我感觉良好",qtgspj:[{pj:"还好"},{pj:"还好"},{pj:"还好"},{pj:"还好"},{pj:"还好"},{pj:"还好"},{pj:"还好"},{pj:"还好"},{pj:"还好"}],bzpj:[{bzpj:"不错"},{bzpj:"不错"},{bzpj:"不错"},{bzpj:"不错"}],liuyan:[{liuyan:"我喜欢你"},{liuyan:"烧死异性恋"}]},errmsg()}for(this.zongfen=b.zongfen,this.paiming=b.paiming,this.bmpm=b.bmpm,this.bmdf=b.bmdf,this.yxgs=b.yxgs,this.arrDFXZ=new Array(b.DFXJ[0].a,b.DFXJ[0].b,b.DFXJ[0].c,b.DFXJ[0].d,b.DFXJ[0].e,b.DFXJ[0].f,b.DFXJ[0].g),this.zwpj=TranStr_Post(b.zwpj),this.qtgspj=new Array,d=0;d<b.qtgspj.length;++d)e=TranStr_Post(b.qtgspj[d].pj),this.qtgspj.push(e);for(this.bzpj=new Array,d=0;d<b.bzpj.length;++d)e=TranStr_Post(b.bzpj[d].bzpj),this.bzpj.push(e);this.liuyan=b.liuyan}var b=new a;return b}function Get_GJBMCQTJ(){function a(){var a,b,d;try{if(debug())throw"ajax";$.ajax({url:URL+"/jsgjbmcqtj",data:{year:year,month:month},async:!1,dataType:"json",type:"POST",success:function(b){a=b}}),b=a}catch(c){alert("hehehheeeeeeeee"),b={gjbm:2,renshu:1,status:0,chuqin:[{name:"邓作恒",qj:0,ct:0,qx:0,account:201205222}]},errmsg()}for(this.gjbm=b.gjbm,this.renshu=b.renshu,this.status=b.status,this.chuqin=new Array,d=0;d<b.chuqin.length;++d)this.chuqin[d]=new Array,this.chuqin[d][0]=b.chuqin[d].name,this.chuqin[d][1]=b.chuqin[d].qj,this.chuqin[d][2]=b.chuqin[d].ct,this.chuqin[d][3]=b.chuqin[d].qx,this.chuqin[d][4]=b.chuqin[d].account}var b=new a;return b}function Post_GJBMCQTJ(a){var c,d,e,b=new Array;for(c=0;c<a.renshu;++c)b.push({name:a.chuqin[c][0],qj:a.chuqin[c][1],ct:a.chuqin[c][2],qx:a.chuqin[c][3],account:a.chuqin[c][4]});d={year:year,month:month,gjbm:a.gjbm,renshu:a.renshu,status:a.status,chuqin:b};try{return debug()?!0:($.ajax({url:URL+"/post_gjbmcqtj",data:d,async:!1,dataType:"json",type:"POST",success:function(a){e=a}}),alert(e.flagCrud+"adsfadsfa"),e.flagCrud)}catch(f){return!1}}function Get_DYYJCN(){function a(){function d(a,b,c){function d(a,b,c){this.name=a,this.account=b,this.jiafen=c}var e,f;for(this.bmmz=a,this.bmrs=b,this.arrObjCNJF=new Array,e=0;e<this.bmrs;++e)f=new d(c[e].name,c[e].account,c[e].jiafen),this.arrObjCNJF.push(f)}var a,b,e,f;try{if(debug())throw"ajax";$.ajax({url:URL+"/jsdyyjcn",data:{year:year,month:month},async:!1,dataType:"json",type:"POST",success:function(b){a=b}}),b=a}catch(c){b={status:0,arrBM:[{bmmz:"2",arrCNJF:[{name:"邓作恒",account:2012032210,jiafen:2}]}]},errmsg()}for(this.status=b.status,this.bmsm=b.bmsm,this.arrObjBM=new Array,e=0;e<b.arrBM.length;++e)f=new d(b.arrBM[e].bmmz,b.arrBM[e].arrCNJF.length,b.arrBM[e].arrCNJF),this.arrObjBM.push(f)}var b=new a;return b}function Post_DYYJCN(a){var c,d,e,f,g,b=new Array;for(c=0;c<a.arrObjBM.length;++c){for(d=new Array,e=0;e<a.arrObjBM[c].arrObjCNJF.length;++e)d.push({name:a.arrObjBM[c].arrObjCNJF[e].name,account:a.arrObjBM[c].arrObjCNJF[e].account,jiafen:a.arrObjBM[c].arrObjCNJF[e].jiafen});b.push({bmmz:a.arrObjBM[c].bmmz,bmrs:a.arrObjBM[c].bmrs,arrCNJF:d})}f={year:year,month:month,status:a.status,bmsm:a.bmsm,arrBM:b};try{return debug()?!0:($.ajax({url:URL+"/post_dyyjcn",data:f,async:!1,dataType:"json",type:"POST",success:function(a){g=a}}),g.flagCrud?!0:!1)}catch(h){}}function Get_ZTKHJGFK(){function a(){function d(a,b){this.bm=arrDepartName[a-1],this.df=b}function f(a,b,c,d){this.bzmz=a,this.account=b,this.ssbm=arrDepartName[c-1],this.df=d}function g(a){function b(a){this.name=a.name,this.account=a.account,this.df=a.df,this.ydyxgs=1==a.ydyxgs?"月度优秀干事":""}this.bm=arrDepartName[a.bm-1],this.arrObjGBMYXGS=new Array;for(var c=0;c<a.GS.length;++c)this.arrObjGBMYXGS.push(new b(a.GS[c]))}function h(a){function b(a){this.name=a.name,this.account=a.account,this.wdcs=a.wdcs}this.bm=arrDepartName[a.bm-1],this.arrObjGBMWDJDRY=new Array;for(var c=0;c<a.GS.length;++c)this.arrObjGBMWDJDRY.push(new b(a.GS[c]))}var a,b,e;try{if(debug())throw"ajax";$.ajax({url:URL+"/jsztkhjgfk",data:{year:year,month:month},async:!1,dataType:"json",type:"POST",success:function(b){a=b}}),b=a}catch(c){b={arrYXBM:[{bm:"4",df:1024}],arrYXBZ:[{bm:"邓作恒",account:2013021120,ssbm:"5",df:1024}],YXGS:{arrBM:[{bm:"2",GS:[{name:"邓作恒",account:2013021120,df:1024,ydyxgs:1}]}]},WDJDRY:{arrBM:[{bm:"3",GS:[{name:"邓作恒",account:2013021120,wdcs:2}]}]}},errmsg()}for(this.arrObjYXBM=new Array,e=0;e<b.arrYXBM.length;++e)this.arrObjYXBM.push(new d(b.arrYXBM[e].bm,b.arrYXBM[e].df));for(this.arrObjYXBZ=new Array,e=0;e<b.arrYXBZ.length;++e)this.arrObjYXBZ.push(new f(b.arrYXBZ[e].bm,b.arrYXBZ[e].account,b.arrYXBZ[e].ssbm,b.arrYXBZ[e].df));for(this.arrObjYXGS=new Array,e=0;e<b.YXGS.arrBM.length;++e)this.arrObjYXGS.push(new g(b.YXGS.arrBM[e]));for(this.arrObjWDJDRY=new Array,e=0;e<b.WDJDRY.arrBM.length;++e)this.arrObjWDJDRY.push(new h(b.WDJDRY.arrBM[e]))}var b=new a;return b}function BZZP_BZ(){function a(){function a(){function a(){this.bz="工作量",this.a="9-10.工作远多于其他部门或本部门内其他部长，难度较大，需要较多时间完成",this.b="7-8.工作与部门内其他部长相当，在承受范围之内",this.c="5-6.工作较部门内其他部长少，利用很少时间便可完成",this.d="3-4.几乎没有工作"}function b(){this.bz="工作态度",this.a="9-10.对工作能够极其积极且认真负责的完成，犯错误能自觉主动对自己的行为及后果负责",this.b="7-8.布置的任务能够完成，积极度一般，犯错能在其他人监督下对自己的行为后果负责",this.c="5-6.布置的任务不一定能认真负责的完成，对于工作中的失误有时逃避或推卸责任",this.d="3-4.布置的任务敷衍不负责，对于工作中的失误总是逃避或推卸责任"}function c(){this.bz="工作方法",this.a="9-10.在工作中逐渐自主创新找到新方法并取得良好的成效，有突破",this.b="7-8.按照固有方式按部就班并认真完成，效果较好",this.c="5-6.按照固有方式完成但效率不高",this.d="3-4.没能找到合适的方法使工作效率降低"}this.xm="工作情况",this.rowspan=14,this.arrObj=new Array(new a,new b,new c)}function b(){function a(){this.bz="发现问题能力",this.a="9-10.能够不断的正确的思考分析问题，并能及时发现存在的问题",this.b="7-8.能分析绝大多数问题，也能发现问题但不太及时",this.c="5-6.分析问题过于简单，发现问题花费时间较长，经常无法发现",this.d="3-4.分析问题过于死板，没条理，无法发现存在的问题"}function b(){this.bz="解决问题能力",this.a="9-10.在发现问题后能主动、及时、效率高、效果好的解决问题，并能继续高质量的完成工作",this.b="7-8.不能十分及时解决问题，有点手忙脚乱，但在他人的提醒下能够解决，效果尚可",this.c="5-6.解决问题不及时，手忙脚乱，较难想到解决的办法",this.d="3-4.完全找不到解决办法，导致了比较严重的后果"}this.xm="工作能力",this.rowspan=10,this.arrObj=new Array(new a,new b)}function c(){function a(){this.bz="沟通能力",this.a="9-10.沟通能力很强，经常与干事、其他部长级和主管副主席进行有效的沟通，效果很好",this.b="7-8.愿意与上级和下级沟通，沟通效果尚可",this.c="5-6.不乐于与人沟通，仅在必要沟通时才会沟通，效果一般",this.d="3-4.沟通合作能力差，不肯与人合作，完全封闭自我"}function b(){this.bz="分工合作能力",this.a="9-10.能有各自明确合力的分工，合作时能够共同出色的完成任务，也能很乐意的接受他人意见，完成工作效率高",this.b="7-8.愿意与他人合作，虽分工欠合理但合作中能够相处愉快，一开始可能有分歧最终也能统一，工作完成效果一般",this.c="5-6.仅在必要时才与人合作，分工混乱且不均，合作中会有摩擦，勉强接受与自己不一致的意见，导致工作效率降低",this.d="3-4.排斥与他人合作，分工情况严重不均，完全无视他人意见，固执己见，十分难以相处，导致工作效率低，效果差"}function c(){this.bz="工作情绪",this.a="9-10.生活中导致的不良情绪极少带到工作和部门活动中，在部门成员面前总是保持较好的状态",this.b="7-8.生活中的不良情绪偶尔会带到工作中来，导致工作效率欠佳，但仍能够较好完成工作",this.c="5-6.不良情绪容易影响到部门工作，工作效率降低，甚至影响到其他同事的情绪",this.d="3-4.不良情绪总是对自己造成极大的影响，严重影响到整个部门的运作"}this.xm="协作能力",this.rowspan=14,this.arrObj=new Array(new a,new b,new c)}function d(){function a(){this.bz="分配工作能力",this.a="9-10.给干事工作布置合理，每个人都有比较平均的任务，完成效果好",this.b="7-8.给干事工作布置欠合理，有的忙有的闲，但工作能够正常完成",this.c="5-6.没有合理分配工作，导致工作勉强完成，而且完成效果欠佳",this.d="3-4.工作分配严重不合理，导致有的干事无法完成工作，效果很差"}function b(){this.bz="督导能力",this.a="9-10.常与干事督导与调练，乐于主动帮助干事，经常给予指导性意见",this.b="7-8.肯应干事要求帮助干事，但缺乏主动性",this.c="5-6.仅在必要时才进行督导，导致干事的工作中出现了较多错误",this.d="3-4.从不督导干事，甚至拒绝干事的督导要求"}function c(){this.bz="部门感情",this.a="9-10.经常组织部门一起活动，没有特殊事务不会缺席，部门内感情很好，其乐融融，有归属感",this.b="7-8.会组织部门一起活动，但有时因为情绪等原因会缺席活动，部门感情尚可",this.c="5-6.部门一起活动的情况少，懒于组织部门活动，部门感情淡薄",this.d="3-4.部门基本没有一起出去活动过，部门内所有人工作热情很低，怨言重"}function d(){this.bz="领导能力",this.a="9-10.能有效组织整个部门积极高效的完成工作，领导执行力强 ",this.b="7-8.能组织部门活动、工作，有一定的领导及执行力 ",this.c="5-6.组织部门成员进行工作有一定难度，缺乏领导力 ",this.d="3-4.很难领导部门成员进行工作，执行力弱 "}this.xm="管理能力",this.rowspan=19,this.arrObj=new Array(new a,new b,new c,new d)}this.arrObj_BZZP=new Array(new a,new b,new c,new d)}var b=new a;return b}function Get_BZZP(){function e(){function f(a){this.name=a.name,this.account=a.account,this.fs=a.fs,this.pj=TranStr_Get(a.pj)}function g(a){this.name=a.name,this.account=a.account,this.depart=a.depart,this.pj=TranStr_Get(a.pj)}var a,c,e;for(this.zongfen=b.zongfen,this.status=b.status,this.arrDF=new Array,a=0,c=0;c<d.arrObj_BZZP.length;++c)for(this.arrDF[c]=new Array,e=0;e<d.arrObj_BZZP[c].arrObj.length;++e)this.arrDF[c][e]=b.arrDF[a++].df;for(this.zwpj=TranStr_Get(b.zwpj),""==this.zwpj&&(this.zwpj="请填写....."),this.arrDQTBZPJ=new Array,c=0;c<b.DQTBZPJ.sum;++c)this.arrDQTBZPJ.push(new f(b.DQTBZPJ.arrBZ[c]));for(this.dzgfzxpj=TranStr_Get(b.dzgfzxpj),""==this.dzgfzxpj&&(this.dzgfzxpj="请填写....."),this.arrNMPJ=new Array,c=0;c<b.NMPJ.length;++c)this.arrNMPJ.push(new g(b.NMPJ[c]));for(this.arrTSLY=b.TongShiliuYan,c=0;c<this.arrTSLY.length;c++)this.arrTSLY[c].liuyan=TranStr_Get(this.arrTSLY[c].liuyan);this.arrTongShi=b.TongShi}var a,b,d,f;try{if(debug())throw"ajax";$.ajax({url:URL+"/funcbzzp",data:{year:year,month:month},async:!1,dataType:"json",type:"POST",success:function(b){a=b}}),b=a}catch(c){b={zongfen:0,status:0,hadSubmit:0,arrDF:[{df:0},{df:0},{df:0},{df:0},{df:0},{df:0},{df:0},{df:0},{df:0},{df:0},{df:0},{df:0},{df:0},{df:0},{df:0},{df:0},{df:0}],zwpj:"",DQTBZPJ:{sum:4,arrBZ:[{name:"邓作恒",account:2013042210,fs:100,pj:"不错"},{name:"邓作恒",account:2013042210,fs:100,pj:"不错"},{name:"邓作恒",account:2013042210,fs:100,pj:"不错"},{name:"邓作恒",account:2013042210,fs:100,pj:"不错"}]},dzgfzxpj:"很好",NMPJ:[{name:"主席",account:2013042210,depart:"副主席",pj:"匿名评价"},{name:"主席",account:2013042210,depart:"副主席",pj:"匿名评价"},{name:"主席",account:2013042210,depart:"副主席",pj:"匿名评价"},{name:"主席",account:2013042210,depart:"副主席",pj:"匿名评价"},{name:"主席",account:2013042210,depart:"副主席",pj:"匿名评价"}],TongShi:[{name:"同事A",account:2012052210},{name:"同事B",account:2012052211},{name:"同事C",account:2012052212},{name:"同事D",account:2012052213},{name:"同事E",account:2012052214},{name:"同事F",account:2012052215}],TongShiliuYan:[{account:2012052210,liuyan:"我喜欢你"},{account:2012052211,liuyan:"我喜欢你的手机"}]},errmsg()}return d=BZZP_BZ(),f=new e}function Post_BZZP(a){var c,d,e,f,g,h,i,b=new Array;for(c=0;c<a.arrDF.length;++c)for(d=0;d<a.arrDF[c].length;++d)b.push({df:a.arrDF[c][d]});for(e=new Array,c=0;c<a.arrDQTBZPJ.length;++c)e.push({name:a.arrDQTBZPJ[c].name,account:a.arrDQTBZPJ[c].account,fs:a.arrDQTBZPJ[c].fs,pj:TranStr_Post(a.arrDQTBZPJ[c].pj)});for(f=new Array,c=0;c<a.arrNMPJ.length;++c)f.push({name:a.arrNMPJ[c].name,account:a.arrNMPJ[c].account,depart:a.arrNMPJ[c].depart,pj:TranStr_Post(a.arrNMPJ[c].pj)});for(g=new Array,c=0;c<a.arrTSLY.length;++c)""!=a.arrTSLY[c].liuyan&&" "!=a.arrTSLY[c].liuyan&&"无"!=a.arrTSLY[c].liuyan&&g.push({account:a.arrTSLY[c].account,liuyan:TranStr_Post(a.arrTSLY[c].liuyan)});h={year:year,month:month,hadSubmit:a.hadSubmit,zongfen:a.zongfen,status:a.status,arrDF:b,zwpj:TranStr_Post(a.zwpj),DQTBZPJ:{sum:a.arrDQTBZPJ.length,arrBZ:e},dzgfzxpj:TranStr_Post(a.dzgfzxpj),NMPJ:{sum:a.arrNMPJ.length,arrNMPJ:f},TSLY:g};try{return debug()?!0:($.ajax({url:URL+"/post_bzzp",data:h,async:!1,dataType:"json",type:"POST",success:function(a){i=a}}),i.flagCrud?!0:!1)}catch(j){}}function GSKH_BZ(){function a(){this.str0='<div id="gzl"><p><h3  style="text-align:center">工作量</h3></p><p>评价标准:</p><p>9-10.工作远多于部门内其他干事，需要较多时间完成</p><p>7-8.工作与部门内其他干事差不多，在承受范围之内</p><p>5-6.工作较部门内其他干事少，利用很少时间便可完成</p><p>3-4.几乎没有工作</p></div>',this.str1='<div id="gzxl"><p><h3  style="text-align:center">工作效率</h3></p><p>评价标准:</p><p>9-10.总能提早截止日期较多完成安排下去的任务</p><p>7-8.能够按时完成安排下去的任务，踩着时间点完成</p><p>5-6.要超时才能完成安排下去的任务</p><p>3-4.无法完成安排下去的任务</p></div>',this.str2='<div id="gzzl"><p><h3  style="text-align:center">工作质量</h3></p><p>评价标准:</p><p>9-10.出色地完成各项任务，并有一定的突破，工作过程中无纰漏和失误，完成质量很高</p><p>7-8.能够顺利按要求完成任务，质量一般，存在一些细节性的失误和漏洞</p><p>5-6.工作或任务内容有一小部分未能完成，存在一定的失误，需要不断修改</p><p>3-4.工作完成情况较差，出现较严重的错误</p></div>',this.str3='<div id="gzzl"><p><h3  style="text-align:center">工作态度</h3></p><p>评价标准:</p><p>9-10.对待工作积极性高，主动要求工作，并且能认真热情的完成；责任感强，犯错时敢作敢担当；纪律性强，严格规范自身，工作严谨</p><p>7-8.对待工作积极性一般，能接受布置的任务；责任感一般，犯错时能在监督下承担自己的责任；纪律性一般，大体遵守规章制度</p><p>5-6.对待工作积极性低，能接受布置的任务但办事拖拉；责任感弱，犯错时会逃避或推卸；纪律性弱，偶尔不守纪律，但提醒后能改正</p><p>3-4.对待工作积极性过低，完成任务时需不断催促；责任感过低，做事敷衍，犯错逃避或推卸责任；纪律性过低，经常不守纪律，再三提醒仍出错</p></div>',this.str4='<div id="jjx"><p><h3  style="text-align:center">工作能力</h3></p><p>评价标准:</p><p>9-10.能很好理解部长级交代的任务，并能在上级经验中加入自己的思考和看法，有创新既灵活又高效率，在遇事能随机应变，首想自己解决而非寻求帮助。</p><p>7-8.能明白部长级交代的任务但仍需询问提醒，工作时中规中矩无新意也能顺利完成，偶尔有新意，在遇事时首想寻求帮助，偶尔自己解决。</p><p>5-6.未能及时理解部长级交代的任务需不断询问提醒，工作时不按照指导爱擅作主张，无想法，只在被问时才偶尔有点想法，遇事时总求助他人，勉强解决问题。</p><p>3-4.不理解部长级交代的任务且在不断提醒后仍态度懒散，工作时自作主张导致失误，基本没有创新，被动下也无新想法，遇事时不会随机应变，也不寻求帮助。</p></div>',this.str5='<div id="hznl"><p><h3  style="text-align:center">合作能力</h3></p><p>评价标准:</p><p>9-10.能够很好的与他人合作，能提出自己想法，发挥自己的作用，也能接受他人意见</p><p>7-8.愿意与他人合作，但合作中能够相处愉快，但不太主动</p><p>5-6.仅在必要时才与人合作，偶尔会有摩擦，勉强接受与自己不一致的意见</p><p>3-4.排斥与他人合作，十分难以相处</p></div>',this.str6='<div id="bdnl"><p><h3  style="text-align:center">表达能力</h3></p><p>评价标准:</p><p>9-10.能够清晰地表达自己的观点，让别人乐于聆听和理解自己的想法</p><p>7-8.能够表达自己的观点，但需要其他人稍作提示</p><p>5-6.表达自己的观点时存在有人听不懂请求解释的情况，但能解释清楚</p><p>3-4.表达自己观点时太含糊，别人完全听不懂，解释自己的观点时也不够清楚</p></div>',this.str7='<div id="tdjs"><p><h3  style="text-align:center">团队精神</h3></p><p>评价标准:</p><p>9-10.爱护团体，有强烈的团队精神，部门内有活动总是热情参与，也常协助其他同事</p><p>7-8.比较爱护团体，能参与部门活动但偶尔会缺席，与其他同事感情良好</p><p>5-6.团队精神欠缺，偶尔不愿意与部门一起活动，才与部门内其他成员沟通少</p><p>3-4.脱离群众，排斥与部门一起活动，更愿意单独行动，必要时才与他人沟通</p></div>'}var b=new a;return b}function Get_GSKH(){function g(){function b(a){this.name=a.name,this.account=a.account,this.df0=a.df0,this.df1=a.df1,this.df2=a.df2,this.df3=a.df3,this.df4=a.df4,this.df5=a.df5,this.df6=a.df6,this.df7=a.df7,this.df8=a.df8,this.df9=a.df9,this.df10=a.df10,this.df11=a.df11,this.df12=a.df12,this.df13=a.df13}function e(a){this.name=a.name,this.account=a.account,this.pj=TranStr_Get(a.pj)}var d;for(this.GSKH_BZ=f,this.status=c.status,this.bmts=a[c.apartment-1],this.arrGSDF=new Array,d=0;d<c.arrGSDF.length;++d)this.arrGSDF.push(new b(c.arrGSDF[d]));for(this.arrDGSPJ=new Array,d=0;d<c.arrDGSPJ.length;++d)this.arrDGSPJ.push(new e(c.arrDGSPJ[d]))}var b,c,e,f,h,a=new Array;a[0]='<div id="bmts"><p><h3  style="text-align:center">秘书处职能</h3></p><p>评价标准:</p><p>文档制作能力、细致认真程度、协调应急能力</p><p>（每一项必须评，每项3.333333分，请直接写出以总分为10分的分数）</p></div>',a[1]='<div id="bmts"><p><h3  style="text-align:center">人力职能</h3></p><p>评价标准:</p><p>软件使用（包括excel，ppt，word）</p><p>撰写能力（写策划的能力和发短信内容）</p></div>',a[2]='<div id="bmts"><p><h3  style="text-align:center">宣传部职能</h3></p><p>立宣制作:</p><p>9-10.立宣的制作方面很有想法，可行性很好</p><p>7-8.立宣的制作想法，可行性基本ok</p><p>5-6.立宣制作方面很有想法，但可行性不足</p><p>3-4.立宣的制作基本没什么想法，跟着别人想法走</p><p>电宣制作:</p><p>9-10.能熟练地运用PS制作电宣，作品效果很好</p><p>7-8.电宣制作基本ok，基本符合活动部门要求</p><p>5-6.电宣制作想法很好，但制作欠佳</p><p>3-4.电宣方面训练不够，作品欠佳</p><p>（立宣制作和电宣制作每项5分，请直接写出以总分为10分的分数）</p></div>',a[3]='<div id="bmts"><p><h3  style="text-align:center">信编职能</h3></p><p>评价说明:</p><p>撰写新闻稿能力，拍照能力，制作视频能力</p><p>（请部长级选择自己了解的一项进行打分，直接写出以总分为10分的分数）</p></div>',a[4]='<div id="bmts"><p><h3  style="text-align:center">部门特色</h3></p><p>评价说明:</p><p>您的部门没有设置部门特色评分项，请填写为0</p></div>',a[5]='<div id="bmts"><p><h3  style="text-align:center">部门特色</h3></p><p>评价说明:</p><p>您的部门没有设置部门特色评分项，请填写为0</p></div>',a[6]='<div id="bmts"><p><h3  style="text-align:center">交流会表现得分</h3></p><p>评价说明:</p><p>根据小干事在交流会上学习的参与积极性以及会后任务题的完成度打分</p><p>（满分10分）</p></div>',a[7]='<div id="bmts"><p><h3  style="text-align:center">部门特色</h3></p><p>活动方面:</p><p>9-10.主动要求任务，对办活动充满热情，并认真负责地完成，并且对活动提出宝贵建议</p><p>7-8.偶尔会提出自己的想法，会负责完成任务</p><p>5-6.觉得无所谓，偶尔不愿意工作，但还是会完成自己的任务，不会提出自己的想法</p><p>3-4.完全被动型，觉得很麻烦，有种被迫去做的感觉</p><p>处理团务:</p><p>9-10.每次都很认真完成任务，并细心、有耐心地尽自己的职责，乐于接受任务</p><p>7-8.会负责任地完成任务，工作效果良好</p><p>5-6.欠缺耐心，有时候不想完成任务，属于被动型</p><p>3-4.觉得团务很麻烦，完全不想完成任务，被催了才会去做</p><p>（处理团务和活动方面每项5分，请直接写出以总分为10分的分数）</p></div>',a[8]='<div id="bmts"><p><h3  style="text-align:center">与部门内其他人联系情况</h3></p><p>9-10.多，积极</p><p>7-8.还行</p><p>5-6.比较少</p><p>3-4.很少</p></div>',a[9]='<div id="bmts"><p><h3  style="text-align:center">部门特色</h3></p><p>评价说明:</p><p>您的部门没有设置部门特色评分项，请填写为0</p></div>',a[10]='<div id="bmts"><p><h3  style="text-align:center">心服职能</h3></p><p>评价说明:</p><p>心理知识</p><p>（满分10分）</p></div>';try{if(debug())throw"ajax";$.ajax({url:URL+"/funcgskh",data:{year:year,month:month},async:!1,dataType:"json",type:"POST",success:function(a){b=a}}),c=b}catch(d){e=new String,c={status:0,bmts:e,hadSubmit:0,arrGSDF:[{name:"干事",account:2014073,df0:10,df1:10,df2:10,df3:10,df4:10,df5:10,df6:10,df7:10,df8:10,df9:10,df10:10,df11:10,df12:10,df13:10},{name:"干事",account:2014073,df0:9,df1:9,df2:9,df3:9,df4:9,df5:9,df6:9,df7:9,df8:9,df9:9,df10:9,df11:9,df12:9,df13:9},{name:"干事",account:2014073,df0:9,df1:9,df2:9,df3:9,df4:9,df5:9,df6:9,df7:9,df8:9,df9:9,df10:9,df11:9,df12:9,df13:9},{name:"干事",account:2014073,df0:9,df1:9,df2:9,df3:9,df4:9,df5:9,df6:9,df7:9,df8:9,df9:9,df10:9,df11:9,df12:9,df13:9},{name:"干事",account:2014073,df0:9,df1:9,df2:9,df3:9,df4:9,df5:9,df6:9,df7:9,df8:9,df9:9,df10:9,df11:9,df12:9,df13:9},{name:"干事",account:2014073,df0:9,df1:9,df2:9,df3:9,df4:9,df5:9,df6:9,df7:9,df8:9,df9:9,df10:9,df11:9,df12:9,df13:9},{name:"干事",account:2014073,df0:9,df1:9,df2:9,df3:9,df4:9,df5:9,df6:9,df7:9,df8:9,df9:9,df10:9,df11:9,df12:9,df13:9},{name:"干事",account:2014073,df0:9,df1:9,df2:9,df3:9,df4:9,df5:9,df6:9,df7:9,df8:9,df9:9,df10:9,df11:9,df12:9,df13:9},{name:"干事",account:2014073,df0:9,df1:9,df2:9,df3:9,df4:9,df5:9,df6:9,df7:9,df8:9,df9:9,df10:9,df11:9,df12:9,df13:9}],arrDGSPJ:[{name:"干事",account:201203,pj:"评价"},{name:"干事",account:201203,pj:"评价"},{name:"干事",account:201203,pj:"评价"},{name:"干事",account:201203,pj:"评价"},{name:"干事",account:201203,pj:"评价"},{name:"干事",account:201203,pj:"评价"},{name:"干事",account:201203,pj:"评价"},{name:"干事",account:201203,pj:"评价"},{name:"干事",account:201203,pj:"评价"},{name:"干事",account:201203,pj:"评价"},{name:"干事",account:201203,pj:"评价"},{name:"干事",account:201203,pj:"评价"}]},errmsg()}return f=GSKH_BZ(),h=new g}function Post_GSKH(a){var c,d,e,f,b=new Array;for(c=0;c<a.arrGSDF.length;++c)b.push({name:a.arrGSDF[c].name,account:a.arrGSDF[c].account,df0:a.arrGSDF[c].df0,df1:a.arrGSDF[c].df1,df2:a.arrGSDF[c].df2,df3:a.arrGSDF[c].df3,df4:a.arrGSDF[c].df4,df5:a.arrGSDF[c].df5,df6:a.arrGSDF[c].df6,df7:a.arrGSDF[c].df7,df8:a.arrGSDF[c].df8,df9:a.arrGSDF[c].df9,df10:a.arrGSDF[c].df10,df11:a.arrGSDF[c].df11,df12:a.arrGSDF[c].df12,df13:a.arrGSDF[c].df13});for(d=new Array,c=0;c<a.arrGSDF.length;++c)d.push({name:a.arrDGSPJ[c].name,account:a.arrDGSPJ[c].account,pj:TranStr_Post(a.arrDGSPJ[c].pj)});e={year:year,month:month,status:a.status,hadSubmit:a.hadSubmit,GSDF:{sum:a.arrGSDF.length,arrGSDF:b},DGSPJ:{sum:a.arrGSDF.length,arrDGSPJ:d}};try{return debug()?!0:($.ajax({url:URL+"/post_gskh",data:e,async:!1,dataType:"json",type:"POST",success:function(a){f=a}}),f.flagCrud?!0:!1)}catch(g){console.log(g)}}function Get_BZFK(){function d(){function d(a){this.name=a.name,this.account=a.account,this.assess=TranStr_Get(a.assess)}var a,c,e;for(this.ZongFen=b.ZongFen,this.arrDeFenXiZhe=new Array(b.arrDeFenXiZhe.a,b.arrDeFenXiZhe.b,b.arrDeFenXiZhe.c,b.arrDeFenXiZhe.d,b.arrDeFenXiZhe.e,b.arrDeFenXiZhe.f,b.arrDeFenXiZhe.g,b.arrDeFenXiZhe.h),this.ZiWoPingJia=TranStr_Get(b.ZiWoPingJia),this.arrQiTaBuZhanPinJia=new Array,a=0;a<b.QiTaBuZhanPinJia.arrQiTaBuZhanPinJia.length;++a)c=TranStr_Get(b.QiTaBuZhanPinJia.arrQiTaBuZhanPinJia[a].pj),this.arrQiTaBuZhanPinJia.push(c);
for(this.ZhuGuanFuZhuXiPinJia=TranStr_Get(b.ZhuGuanFuZhuXiPinJia),e=new Array,a=0;a<b.GSZP.arrGSZP.length;a++)e[a]=new d(b.GSZP.arrGSZP[a]);for(this.arrGanShiPingJia=new Array,a=0;a<b.GanShiPingJia.arrGanShiPingJia.length;++a)c=TranStr_Get(b.GanShiPingJia.arrGanShiPingJia[a].gspj),this.arrGanShiPingJia.push(c);for(this.arrLiuYan=new Array,a=0;a<b.LiuYan.length;a++)c=TranStr_Get(b.LiuYan[a].liuyan),""!=c&&"无"!=c&&" "!=c&&this.arrLiuYan.push(c);for(this.arrBuMenLiuYan=new Array,a=0;a<b.BuMenLiuYan.length;a++)c=TranStr_Get(b.BuMenLiuYan[a].liuyan),""!=c&&"无"!=c&&" "!=c&&this.arrBuMenLiuYan.push(c);this.arrGanShiZhiWoPinJia=e,this.arrGanShiDeFengPaiMing=b.arrGSPM,this.BuMenDeFeng=b.BuMenDeFeng,this.arrBuMenPaiMing=b.BuMenPaiMing,this.arrBuMenDeFenXiZhe=new Array(b.arrBuMenDeFenXiZhe.a,b.arrBuMenDeFenXiZhe.b,b.arrBuMenDeFenXiZhe.c,b.arrBuMenDeFenXiZhe.d,b.arrBuMenDeFenXiZhe.e,b.arrBuMenDeFenXiZhe.f,b.arrBuMenDeFenXiZhe.g,b.arrBuMenDeFenXiZhe.h),this.ZhuGuanFuZhuXiBuMenPinJia=TranStr_Get(b.ZhuGuanFuZhuXiBuMenPinJia),this.ZhuXiDeBuMenPinJia=TranStr_Get(b.ZhuXiDeBuMenPinJia)}var a,b,e;try{if(debug())throw"ajax";$.ajax({url:URL+"/jsbzfk",data:{year:year,month:month},async:!1,dataType:"json",type:"POST",success:function(b){a=b}}),b=a}catch(c){b={ZongFen:1024,arrDeFenXiZhe:{a:2,b:4,c:8,d:16,e:32,f:64,g:128,h:256},ZiWoPingJia:"还好吧，很好，非常好，无与伦比",QiTaBuZhanPinJia:{sum:3,arrQiTaBuZhanPinJia:[{pj:"还好"}]},ZhuGuanFuZhuXiPinJia:"还好吧，很好，非常好，无与伦比",GSZP:{sum:15,arrGSZP:[{name:"干事1",account:2014052211,assess:"还好吧的干事自评"}]},arrGSPM:[{name:"干事1",score:"100"}],GanShiPingJia:{sum:4,arrGanShiPingJia:[{gspj:"还好吧"}]},BuMenDeFeng:"1024",BuMenPaiMing:[{bm:1,df:1234},{bm:2,df:123},{bm:3,df:12},{bm:4,df:1}],arrBuMenDeFenXiZhe:{a:2,b:4,c:8,d:16,e:32,f:64,g:128,h:256},ZhuGuanFuZhuXiBuMenPinJia:"还好吧",ZhuXiDeBuMenPinJia:"还好吧",LiuYan:[{liuyan:"你欠我的50块什么时候还- -"},{liuyan:"下个星期还你- -"},{liuyan:"无"},{liuyan:" "}],BuMenLiuYan:[{liuyan:"这个部门还是撤了吧- -"},{liuyan:"我上次活动的前还没报销呢"}]},errmsg()}return e=new d}function BZKH_BZ(){function a(){this.str0='<div id="gtnl"><p><h3  style="text-align:center">沟通能力</h3></p><p>评价标准:</p><p>9-10.沟通能力很强，能够经常与上级和下级进行有效的沟通，效果很好</p><p>7-8.愿意与上级和下级沟通，沟通效果尚可</p><p>5-6.不乐于与人沟通，仅在必要沟通时才会沟通，效果一般</p><p>3-4.沟通合作能力差，不肯与人合作，完全封闭自我</p></div>',this.str1='<div id="hznl"><p><h3  style="text-align:center">合作能力</h3></p><p>评价标准:</p><p>9-10.能够很好的与他人合作，能提出自己想法，发挥自己的作用，也能接受他人意见</p><p>7-8.愿意与他人合作，但合作中能够相处愉快，但不太主动</p><p>5-6.仅在必要时才与人合作，偶尔会有摩擦，勉强接受与自己不一致的意见</p><p>3-4.排斥与他人合作，十分难以相处</p></div>',this.str2='<div id="bdnl"><p><h3  style="text-align:center">表达能力</h3></p><p>评价标准:</p><p>9-10.能够清晰地表达自己的观点，让别人乐于聆听和理解自己的想法</p><p>7-8.能够表达自己的观点，但需要其他人稍作提示</p><p>5-6.表达自己的观点时存在有人听不懂请求解释的情况，但能解释清楚</p><p>3-4.表达自己观点时太含糊，别人完全听不懂，解释自己的观点时也不够清楚</p></div>',this.str3='<div id="jjwtnl"><p><h3  style="text-align:center">管理能力</h3></p><p>评价标准:</p><p>9-10.能很好地管理部门事务和干事工作，有条理性，恰到好处，使工作能井然有序进行。</p><p>7-8.能较好地管理部门事务和干事工作，有少许纰漏导致少许失序，但工作亦能较好进行。</p><p>5-6.能一般地管理部门失误和干事工作，纰漏略多，失误略多，工作未能较好进行。</p><p>3-4.太放任管理部门事务和干事工作不管，导致失误多，工作效果差，无法完成任务。</p></div>',this.str4='<div id="lddnl"><p><h3  style="text-align:center">领导能力</h3></p><p>评价标准:</p><p>9-10.能有效组织整个部门积极高效的完成工作，领导执行力强 </p><p>7-8.能组织部门活动、工作，有一定的领导及执行力 </p><p>5-6.组织部门成员进行工作有一定难度，缺乏领导力 </p><p>3-4.很难领导部门成员进行工作，执行力弱 </p></div>',this.str5='<div id="gzl"><p><h3  style="text-align:center">工作量</h3></p><p>评价标准:</p><p>9-10.工作远多于其他部门或本部门内其他部长，难度较大，需要较多时间完成</p><p>7-8.工作与部门内其他部长相当，在承受范围之内</p><p>5-6.工作较部门内其他部长少，利用很少时间便可完成</p><p>3-4.几乎没有工作</p>',this.str6='<div id="wcqk"><p><h3  style="text-align:center">工作方法</h3></p><p>评价标准:</p><p>9-10.在工作中逐渐自主创新找到新方法并取得良好的成效，有突破</p><p>7-8.按照固有方式按部就班并认真完成，效果较好</p><p>5-6.按照固有方式完成但效率不高</p><p>3-4.没能找到合适的方法使工作效率降低</p></div>',this.str7='<div id="gzff"><p><h3  style="text-align:center">工作态度</h3></p><p>评价标准:</p><p>9-10.对工作能够极其积极认真负责的完成，犯错误能自觉主动对自己的行为及后果负责</p><p>7-8.布置的任务能够完成，积极度一般，犯错能在其他人监督下对自己的行为后果负责</p><p>5-6.布置的任务不一定能认真负责的完成，对于工作中的失误有时逃避或推卸责任</p><p>3-4.布置的任务敷衍不负责，对于工作中的失误总是逃避或推卸责任</p></div>',this.str8='<div id="tcnl"><p><h3  style="text-align:center">工作能力</h3></p><p>评价标准:</p><p>9-10.善于统筹规划，大局与细节并重，细心认真，能不断正确思考分析问题并时常能有新想法，及时发现并较好地解决问题给部门带来利益，遇事能随机应变，自行解决不求他人</p><p>7-8.能顺利完成任务，细节方面有瑕疵，效果尚可，能思考问题，偶尔能主动提出新想法，但难以较好的解决问题，遇事时先求助他人，偶尔自行解决</p><p>5-6.统筹能力不够，细节照顾不够，任务未能顺利完成，难以发现问题，基本无创新思想，发现问题亦需花费不少时间解决，遇事时求助他人不求自己，勉强完成任务</p><p>3-4.基本未完成任务，细节忽略较多，无法发现问题，待提醒后亦未几时解决问题，无创新能力，无想法，遇事不随机应变，不求助亦不自助</p></div>'}var b=new a;return b}function Get_BZKH(){function d(){function a(a){function b(a){this.bzmz=a.bzmz,this.account=a.account,this.pj=TranStr_Get(a.pj),this.df0=a.df0,this.df1=a.df1,this.df2=a.df2,this.df3=a.df3,this.df4=a.df4,this.df5=a.df5,this.df6=a.df6,this.df7=a.df7,this.df8=a.df8,this.df9=a.df9,this.df10=a.df10,this.df11=a.df11,this.df12=a.df12,this.df13=a.df13,this.df14=a.df14}this.bm=TranDigToText(a.bm),this.arrBZ=new Array;for(var c=0;c<a.arrBZ.length;++c)this.arrBZ.push(new b(a.arrBZ[c]))}this.status=b.status,this.BZKH_BZ=new BZKH_BZ,this.arrBMBZ=new Array;for(var c=0;c<b.BMBZ.arrBM.length;++c)this.arrBMBZ.push(new a(b.BMBZ.arrBM[c]));this.hadSubmit=b.BMBZ.hadSubmit}var a,b,e;try{if(debug())throw"ajax";$.ajax({url:URL+"/funcbzkh",data:{year:year,month:month},async:!1,dataType:"json",type:"POST",success:function(b){a=b}}),b=a}catch(c){b={status:0,hadSubmit:0,BMBZ:{bmsm:3,arrBM:[{bm:1,bzrs:4,arrBZ:[{bzmz:"部长",account:20120421,pj:"评价",df0:0,df1:1,df2:2,df3:3,df4:4,df5:5,df6:6,df7:7,df8:8,df9:9,df10:10,df11:11,df12:12,df13:13,df14:14},{bzmz:"部长",account:20120421,pj:"评价",df0:0,df1:1,df2:2,df3:3,df4:4,df5:5,df6:6,df7:7,df8:8,df9:9,df10:10,df11:11,df12:12,df13:13,df14:14},{bzmz:"部长",account:20120421,pj:"评价",df0:0,df1:1,df2:2,df3:3,df4:4,df5:5,df6:6,df7:7,df8:8,df9:9,df10:10,df11:11,df12:12,df13:13,df14:14},{bzmz:"部长",account:20120421,pj:"评价",df0:0,df1:1,df2:2,df3:3,df4:4,df5:5,df6:6,df7:7,df8:8,df9:9,df10:10,df11:11,df12:12,df13:13,df14:14}]},{bm:2,bzrs:4,arrBZ:[{bzmz:"部长",account:20120421,pj:"评价",df0:0,df1:1,df2:2,df3:3,df4:4,df5:5,df6:6,df7:7,df8:8,df9:9,df10:10,df11:11,df12:12,df13:13,df14:14},{bzmz:"部长",account:20120421,pj:"评价",df0:0,df1:1,df2:2,df3:3,df4:4,df5:5,df6:6,df7:7,df8:8,df9:9,df10:10,df11:11,df12:12,df13:13,df14:14},{bzmz:"部长",account:20120421,pj:"评价",df0:0,df1:1,df2:2,df3:3,df4:4,df5:5,df6:6,df7:7,df8:8,df9:9,df10:10,df11:11,df12:12,df13:13,df14:14},{bzmz:"部长",account:20120421,pj:"评价",df0:0,df1:1,df2:2,df3:3,df4:4,df5:5,df6:6,df7:7,df8:8,df9:9,df10:10,df11:11,df12:12,df13:13,df14:14}]},{bm:3,bzrs:4,arrBZ:[{bzmz:"部长",account:20120421,pj:"评价",df0:0,df1:1,df2:2,df3:3,df4:4,df5:5,df6:6,df7:7,df8:8,df9:9,df10:10,df11:11,df12:12,df13:13,df14:14},{bzmz:"部长",account:20120421,pj:"评价",df0:0,df1:1,df2:2,df3:3,df4:4,df5:5,df6:6,df7:7,df8:8,df9:9,df10:10,df11:11,df12:12,df13:13,df14:14},{bzmz:"部长",account:20120421,pj:"评价",df0:0,df1:1,df2:2,df3:3,df4:4,df5:5,df6:6,df7:7,df8:8,df9:9,df10:10,df11:11,df12:12,df13:13,df14:14},{bzmz:"部长",account:20120421,pj:"评价",df0:0,df1:1,df2:2,df3:3,df4:4,df5:5,df6:6,df7:7,df8:8,df9:9,df10:10,df11:11,df12:12,df13:13,df14:14}]}]}},errmsg()}return e=new d}function Post_BZKH(a){var c,d,e,f,g,b=new Array;for(c=0;c<a.arrBMBZ.length;++c){for(d=new Array,e=0;e<a.arrBMBZ[c].arrBZ.length;++e)d.push({bzmz:a.arrBMBZ[c].arrBZ[e].bzmz,account:a.arrBMBZ[c].arrBZ[e].account,pj:TranStr_Post(a.arrBMBZ[c].arrBZ[e].pj),df0:a.arrBMBZ[c].arrBZ[e].df0,df1:a.arrBMBZ[c].arrBZ[e].df1,df2:a.arrBMBZ[c].arrBZ[e].df2,df3:a.arrBMBZ[c].arrBZ[e].df3,df4:a.arrBMBZ[c].arrBZ[e].df4,df5:a.arrBMBZ[c].arrBZ[e].df5,df6:a.arrBMBZ[c].arrBZ[e].df6,df7:a.arrBMBZ[c].arrBZ[e].df7,df8:a.arrBMBZ[c].arrBZ[e].df8,df9:a.arrBMBZ[c].arrBZ[e].df9,df10:a.arrBMBZ[c].arrBZ[e].df10,df11:a.arrBMBZ[c].arrBZ[e].df11,df12:a.arrBMBZ[c].arrBZ[e].df12,df13:a.arrBMBZ[c].arrBZ[e].df13,df14:a.arrBMBZ[c].arrBZ[e].df14});b.push({bm:TranTextToDig(a.arrBMBZ[c].bm),bzrs:a.arrBMBZ[c].arrBZ.length,arrBZ:d})}f={year:year,month:month,status:a.status,hadSubmit:a.hadSubmit,BMBZ:{bmsm:a.arrBMBZ.length,arrBM:b}};try{return debug()?!0:($.ajax({url:URL+"/post_bzkh",data:f,async:!1,dataType:"json",type:"POST",success:function(a){g=a}}),g.status?!0:!1)}catch(h){}}function BMKH_BZ(){function a(){this.str0='<div id="gznd"><p><h3  style="text-align:center">工作量/工作难度</h3></p><p>评价标准:</p><p>9-10.工作量远高于其他部门，工作难度也很大</p><p>7-8.工作量与其他部门相当，工作难度适中</p><p>5-6.工作量较其他部门较少，不太有难度</p><p>3-4.工作量远少于其他部门，能够很轻松的完成</p></div>',this.str1='<div id="gzwcxg"><p><h3  style="text-align:center">工作完成效果</h3></p><p>评价标准:</p><p>9-10.很满意，完成的超出预期，效果很好，各方面反响都比较热烈</p><p>7-8.基本满意，能够顺利完成，虽有些细节没有注意，也达到预期效果，反响较好</p><p>5-6.基本完成，但许多细节没有注意，也稍微不及预想效果，反响一般</p><p>3-4.基本未完成，犯了比较严重的错误，远不及预期效果，反响较差</p></div>',this.str2='<div id="gztd"><p><h3  style="text-align:center">工作态度</h3></p><p>评价标准:</p><p>9-10.各成员都能积极完成工作，并对工作认真负责</p><p>7-8.各成员能按要求完成工作，但积极性一般</p><p>5-6.有部分成员对工作不够热心，不能很好地配合部门工作</p><p>3-4.整个部门做事松散，不能及时有序的完成工作要求</p></div>',this.str3='<div id="jlx"><p><h3  style="text-align:center">纪律性</h3></p><p>评价标准:</p><p>9-10.部门内所有成员都有良好的纪律意识，严格规范自身，不随意违反制度，工作作风严谨</p><p>7-8.能履行职责，成员大体上能遵守各项规章制度，但有个别分子作风比较随意</p><p>5-6.偶尔有成员会发生不守纪律的事情，给部门或兄弟部门带来不便，但在他人提醒下能够改正</p><p>3-4.成员经常发生不守纪律的事，他人再三提醒下还会出现问题，不愿改正</p>',this.str4='<div id="bmnjl"><p><h3  style="text-align:center">部门凝聚力</h3></p><p>评价标准:</p><p>9-10.部门成员团结一致，奋发向上，所有成员感情很好，其乐融融，有归属感</p><p>7-8.部门感情较好，部门成员能按要求工作，也较有热情</p><p>5-6.部门成员合作中有时分歧且不能及时解决，导致工作热情降低，内部感情淡薄</p><p>3-4.部门成员无法合作，所有人工作热情很低，怨言重，而且十分松散</p></div>',this.str5='<div id="gthznl"><p><h3  style="text-align:center">沟通合作能力</h3></p><p>评价标准:</p><p>9-10.能跟其他兄弟部门很好的沟通交流合作，尊重其他部门工作，相处十分和谐，合作效果很好</p><p>7-8.跟兄弟部门合作效果尚可，偶尔发生分歧，但最终能共同完成任务</p><p>5-6.跟兄弟部门合作时有分歧且不能及时解决，导致关系较差，影响了合作关系</p><p>3-4.跟兄弟部门成员完全无法合作，以本部门为中心，完全不顾其他部门</p></div>',this.str6='<div id="bmcybx"><p><h3  style="text-align:center">部门成员表现</h3></p><p>评价标准:</p><p>9-10.部长级能发挥应有的带头作用，干事能够听从部长级的安排，部门内工作进行的有条不紊</p><p>7-8.部长级能够管理部门，但干事偶尔有不听从部长级安排的行为，但部门运作尚能进行</p><p>5-6.部长级难以发挥其作用，干事不听从部长级安排，影响部门运作</p><p>3-4.部长级完全无法管理整个部门，干事作风十分随意，严重影响部门运作</p></div>'}var b=new a;return b}function Get_BMKH(){function d(){function a(a){this.bm=TranDigToText(a.bm),this.pj=TranStr_Get(a.pj),this.df0=a.df0,this.df1=a.df1,this.df2=a.df2,this.df3=a.df3,this.df4=a.df4,this.df5=a.df5,this.df6=a.df6}var c;for(this.status=b.status,this.BMKH_BZ=new BMKH_BZ,this.arrBM=new Array,c=0;c<b.BM.arrBM.length;++c)this.arrBM.push(new a(b.BM.arrBM[c]));for(this.arrBuMen=new Array,c=0;c<b.BuMen.length;++c)this.arrBuMen.push({name:TranDigToText(b.BuMen[c].name)});this.TYBM=b.TYBM,this.hadSubmit=b.hadSubmit}var a,b,e;try{if(debug())throw"ajax";$.ajax({url:URL+"/funcbmkh",data:{year:year,month:month},async:!1,dataType:"json",type:"POST",success:function(b){a=b}}),console.log(a),b=a}catch(c){b={status:0,hadSubmit:0,BM:{sum:4,arrBM:[{bm:1,pj:"评价",df0:0,df1:1,df2:2,df3:3,df4:4,df5:5,df6:6},{bm:2,pj:"评价",df0:0,df1:1,df2:2,df3:3,df4:4,df5:5,df6:6},{bm:3,pj:"评价",df0:0,df1:1,df2:2,df3:3,df4:4,df5:5,df6:6},{bm:4,pj:"评价",df0:0,df1:1,df2:2,df3:3,df4:4,df5:5,df6:6}]},BuMen:[{name:1},{name:2},{name:3},{name:4},{name:5},{name:6},{name:7},{name:8},{name:9},{name:10}],TYBM:2},errmsg()}return e=new d}function Post_BMKH(a){var c,d,e,b=new Array;for(c=0;c<a.arrBM.length;++c)b.push({bm:arrDepartName.indexOf(a.arrBM[c].bm)+1,pj:a.arrBM[c].pj,df0:a.arrBM[c].df0,df1:a.arrBM[c].df1,df2:a.arrBM[c].df2,df3:a.arrBM[c].df3,df4:a.arrBM[c].df4,df5:a.arrBM[c].df5,df6:a.arrBM[c].df6});d={year:year,month:month,status:a.status,hadSubmit:a.hadSubmit,BM:{sum:a.arrBM.length,arrBM:b},TYBM:a.TYBM},console.log(d);try{return debug()?!0:($.ajax({url:URL+"/post_bmkh",data:d,async:!1,dataType:"json",type:"POST",success:function(a){e=a}}),alert(e.status),e.flagCrud?!0:!1)}catch(f){}}function Get_YXBZPD(){var a,b,d,e;try{if(debug())throw"ajax";$.ajax({url:URL+"/funcyxbz",data:{year:year,month:month},async:!1,dataType:"json",type:"POST",success:function(b){a=b}}),b=a}catch(c){b={status:0,arrYXBZPDlist:[{name:"部长11",account:"201205220",Checked:!0,depart:"2",score:"9.3948"},{name:"部长222",account:"201205221",Checked:!0,depart:"2",score:"9.48607"},{name:"部长3",account:"201205222",Checked:!0,depart:"2",score:"9.5"},{name:"部长",account:"201205223",Checked:!0,depart:"2",score:"9.2"}]},errmsg()}for(d=0;d<b.arrYXBZPDlist.length;d++)e=b.arrYXBZPDlist[d].depart,b.arrYXBZPDlist[d].depart=arrDepartName[e-1];return b}function Get_ZXTFK(){function d(){this.arrSorted=new Array,this.arrExcMin=new Array,this.arrMinFeedBack=new Array,this.arrAnonymity=new Array}var a,b,e,f;try{if(debug())throw"ajax";$.ajax({url:URL+"/jszxtfk",data:{year:year,month:month},async:!1,dataType:"json",type:"POST",success:function(b){a=b}}),b=a}catch(c){b={classSortDepart:{sum:11,arrSorted:[{name:2,score:1024,isExc:!0}]},ExcMinster:[{name:"某部长",depart:3,score:1024}],classSituation:{sum:5,arrMinFeedBack:[{depart:4,minister:"某部长",selfAssess:"还好吧,应该还好，其实挺好，一切正常，自我感觉良好",feedBack:"很好，非常好，很称职，很有深度，很有魄力，很有能力，很有霸气"}]},_arrAnonymity:[{anonymityFeedBack:"这人身高太逆天"}]}}for(e=new d,e.arrSorted=b.classSortDepart.arrSorted,e.arrExcMin=b.ExcMinster,e.arrMinFeedBack=b.classSituation.arrMinFeedBack,e.arrAnonymity=b._arrAnonymity,f=0;f<e.arrMinFeedBack.length;++f)e.arrMinFeedBack[f].selfAssess=TranStr_Get(e.arrMinFeedBack[f].selfAssess),e.arrMinFeedBack[f].feedBack=TranStr_Get(e.arrMinFeedBack[f].feedBack);for(f=0;f<e.arrAnonymity.length;++f)e.arrAnonymity[f].anonymityFeedBack=TranStr_Get(e.arrAnonymity[f].anonymityFeedBack);return e}function Post_YXBZPD(a){var b,c,d,e,f;for(console.log(a),b=new Array,c=0;c<a.length;c++)d={account:a[c]},b[c]=d;e={year:year,month:month,arrIDlist:b},console.log(e);try{return debug()?!0:($.ajax({url:URL+"/post_yxbz",data:e,async:!1,dataType:"json",type:"POST",success:function(a){f=a,alert(111)}}),alert(f.status),f.flagCrud?!0:!1)}catch(g){}}function Get_KHJCKZ(){var a={KSKH:1,KSPD:0,FBJG:0};return a}function Post_KHJCKZ(a){return!0}function Get_QTQKJJF(){var a,b,d;try{if(debug())throw"ajax";$.ajax({url:URL+"/funcqt",data:{year:year,month:month},async:!1,dataType:"json",type:"POST",success:function(b){a=b}}),b=a}catch(c){b={year:0,month:0,status:0,gjbm:"1",persons:[{name:"姓名",account:201202222,depart:"职位",jiajianfen:-3,liyou:"理由"},{name:"姓名",account:201202222,depart:"职位",jiajianfen:-3,liyou:"理由"},{name:"姓名",account:201202222,depart:"职位",jiajianfen:-3,liyou:"理由"},{name:"姓名",account:201202222,depart:"职位",jiajianfen:-3,liyou:"理由"},{name:"姓名",account:201202222,depart:"职位",jiajianfen:-3,liyou:"理由"},{name:"姓名",account:201202222,depart:"职位",jiajianfen:-3,liyou:"理由"},{name:"姓名",account:201202222,depart:"职位",jiajianfen:-3,liyou:"理由"},{name:"姓名",account:201202222,depart:"职位",jiajianfen:-3,liyou:"理由"},{name:"姓名",account:201202222,depart:"职位",jiajianfen:-3,liyou:"理由"},{name:"姓名",account:201202222,depart:"职位",jiajianfen:-3,liyou:"理由"}],bmjjf:{name:"1",jiajianfen:-3,liyou:"理由"}},errmsg()}for(d=0;d<b.persons.length;++d)b.persons[d].liyou=TranStr_Get(b.persons[d].liyou);return b}function POST_QTQKJJF(a){var b,c;a.year=year,a.month=month;try{if(debug())throw"ajax";return b=a,$.ajax({url:URL+"/post_qt",data:b,async:!1,dataType:"json",type:"POST",success:function(a){c=a}}),c.flagCrud?!0:!1}catch(d){console.log(d)}}function Get_YXPDXZ(){var a,b,c,d,e;try{if(debug())throw"ajax";for($.ajax({url:URL+"/funcyxchxz",data:{year:year,month:month},async:!1,dataType:"json",type:"POST",success:function(b){a=b}}),b=a,c=0;c<b.arrDepart.length;++c)for(b.arrDepart[c].depart=TranDigToText(b.arrDepart[c].depart),d=0;d<b.arrDepart[c].arrPersons.length;++d)b.arrDepart[c].arrPersons[d].check=1==b.arrDepart[c].arrPersons[d].check?!0:!1;for(e=0;e<b.arrBMPD.length;++e)b.arrBMPD[e].depart=TranDigToText(b.arrBMPD[e].depart),b.arrBMPD[e].check=1==b.arrBMPD[e].check?!0:!1}catch(f){b={year:year,month:month,status:0,arrDepart:[{depart:"部门",arrPersons:[{name:"部长",account:2013042212,check:!0},{name:"部长",account:2013042212,check:!0}]}],arrBMPD:[{depart:"部门",check:!0},{depart:"部门",check:!0}]},errmsg()}return b}function Post_YXPDXZ(a){var b,c,d,e,f;for(b=0;b<a.arrDepart.length;++b)for(json_Get_YXPDXZ.arrDepart[b].depart=TranTextToDig(json_Get_YXPDXZ.arrDepart[b].depart),c=0;c<a.arrDepart[b].arrPersons.length;++c)a.arrDepart[b].arrPersons[c].check=1==a.arrDepart[b].arrPersons[c].check?!0:!1;for(d=0;d<a.arrBMPD.length;++d)json_Get_YXPDXZ.arrBMPD[d].depart=TranTextToDig(json_Get_YXPDXZ.arrBMPD[d].depart),a.arrBMPD[d].check=1==a.arrBMPD[d].check?!0:!1;a.year=year,a.month=month,e=a;try{return debug()?!0:($.ajax({url:URL+"/post_yxchxz",data:e,async:!1,dataType:"json",type:"POST",success:function(a){f=a}}),!0)}catch(g){console.log(g)}}function Get_CKWWCQK(){try{if(debug())throw"ajax";var a;$.ajax({url:URL+"/funcUnfinished",data:{year:year,month:month},async:!1,dataType:"json",type:"POST",success:function(b){a=b}}),json_Get_CKWWCQK=a}catch(b){json_Get_CKWWCQK={statusGSZP:0,statusYXBZPD:1,arrGSZP:[{name:"干事1",depart:2,hadSubmit:1},{name:"干事2",depart:3,hadSubmit:0},{name:"干事1",depart:2,hadSubmit:1},{name:"干事2",depart:3,hadSubmit:0}],arrBZZP:[{name:"部长1",depart:3,hadSubmit:1},{name:"部长2",depart:4,hadSubmit:0}],arrGSKH:[{name:"部长1",depart:5,hadSubmit:1},{name:"部长2",depart:5,hadSubmit:0}],arrBZKH:[{name:"主席1",hadSubmit:1},{name:"主席2",hadSubmit:0}],arrBMKH:[{name:"主席3",hadSubmit:1},{name:"主席4",hadSubmit:0}]},errmsg()}return console.log("获取未完成信息:\n"),console.log(json_Get_CKWWCQK),json_Get_CKWWCQK}function Get_WJDJ(a){try{if(debug())throw"ajax";var b;$.ajax({url:URL+"/funcbmwg",data:{year:year,month:month,type:a+1},async:!1,dataType:"json",type:"POST",success:function(a){b=a}}),alert(b.type),json_Get_WJDJ=b}catch(c){json_Get_WJDJ={status:1,arrWJDJB:[{bm:"1",kf:"0.5",ly:"1借物资没有提前联系"},{bm:"2",kf:"0.6",ly:"2借物资没有提前联系"}]},errmsg()}return json_Get_WJDJ}function Post_WJDJ(a,b){try{if(debug())return!0;var c;return $.ajax({url:URL+"/post_bmwg",data:{arrBMWG:a,type:b+1,year:year,month:month},async:!1,dataType:"json",type:"POST",success:function(a){c=a}}),c.flagCrud?!0:!1}catch(d){console.log(d)}}function Show_GSZP(){function f(){strID=this.id,strIndex=strID.replace("delete_liuyan_",""),a.arrTongshiliuyan.splice(strIndex,1),h(),g()}function g(){var b;for(b=0;b<a.arrTongshiliuyan.length;b++)GetObjById("liuyan_"+b).value=a.arrTongshiliuyan[b].liuyan;for(b=0;b<a.arrTongshiliuyan.length;b++)GetObjById("delete_liuyan_"+b).onclick=f,GetObjById("liuyanban_"+b).onchange=function(){strID=this.id,strIndex=strID.replace("liuyanban_",""),a.arrTongshiliuyan[strIndex].account=this.value,GetObjById("liuyan_"+strIndex).value="",a.arrTongshiliuyan[strIndex].liuyan=""},GetObjById("liuyan_"+b).onchange=function(){return strID=this.id,strIndex=strID.replace("liuyan_",""),CheckLegalStr(this.value)?(a.arrTongshiliuyan[strIndex].liuyan=this.value,void 0):(alert("您的输入含有非法字段，请重新输入!"),this.value=a.arrTongshiliuyan[strIndex].liuyan,!1)}}function h(){var c,d,b=new String;for(c=0;c<a.arrTongshiliuyan.length;c++){for(b+='<select id="liuyanban_'+c+'">',d=0;d<a.arrTongShi.length;d++)b+='<option value="'+a.arrTongShi[d].account+'"',a.arrTongshiliuyan[c].account==a.arrTongShi[d].account&&(b+='selected="selected"'),b+=";>"+a.arrTongShi[d].name+"</option>";b+='</select><input type="text" size="80" class="perf_textarea" id="liuyan_'+c+'"/><span class="onclick" id="delete_liuyan_'+c+'">删除</span><br />'}GetObjById("liuyanban").innerHTML=b}function n(){var b,c,d,e,f;for(b=0;b<a.objGSZP_BZ.arrObj_GSZP.length;++b)for(c=0;c<a.objGSZP_BZ.arrObj_GSZP[b].arrObj.length;++c)if(d="df_"+b+"_"+c,""==GetObjById(d).value)return!1;if(""==GetObjById("ziwopingjia").value)return!1;if(""==GetObjById("tuiyouliyou").value)return!1;for(c=0;c<a.arrDBZPJ.length;++c)if(e="fenshu_"+c,f="pingjia_"+c,""==GetObjById(e).value||""==GetObjById(f).value)return!1;return!0}function o(){var b,c;if(!n())return alert("提交前不允许留有空白"),!1;for(b=0;b<a.objGSZP_BZ.arrObj_GSZP.length;++b)for(c=0;c<a.objGSZP_BZ.arrObj_GSZP[b].arrObj.length;++c)if(0==a.arrDF[b][c])return alert("评分部分第"+(b+1)+"大项第"+(c+1)+"小项分数为零或未填写，不允许这样提交"),!1;for(b=0;b<a.arrDBZPJ.length;++b){if(0==a.arrDBZPJ[b].fs)return alert("你对"+a.arrDBZPJ[b].name+"部长的评分为0,表酱紫"),!1;if(("无"==a.arrDBZPJ[b].pj||""==a.arrDBZPJ[b].pj)&&0==confirm("你对"+a.arrDBZPJ[b].name+"部长的评价未填写，你确定就这样提交？"))return!1}return"无"!=a.zwpj&&""!=a.zwpj&&"请填写....."!=a.zwpj||0!=confirm("你的自我评价未填写，你确定就这样提交？")?!0:!1}var c,d,e,i,j,k,l,m,a=Get_GSZP(),b="";for(b+='<h3>自我评分部分</h3>\n   <p class="fill_in_tips">\n    <span class="till_part">填写指引：</span>满分10分，A项对应9-10分，B项对应7-8分，C项对应5-6分，D项对应3-4分，请按照自己的真实情况自评\n   </p>\n   <form method="post" action="#">\n    <table class="yijibiao">\n     <tr>\n      <td colspan="2" scope="col">考核项目</td><td>评价标准</td><td>得分</td>\n     </tr>\n     <tr><td class="blankline" colspan="4" scope="col"></td></tr><!--空行-->\n',c=0;c<a.objGSZP_BZ.arrObj_GSZP.length;++c)for(b+="<tr>\n    <td rowspan="+a.objGSZP_BZ.arrObj_GSZP[c].rowspan+' scope="row"><p1>'+a.objGSZP_BZ.arrObj_GSZP[c].xm+"</p1></td><!--一级项目-->\n",d=0;d<a.objGSZP_BZ.arrObj_GSZP[c].arrObj.length;++d)e="df_"+c+"_"+d,0!=d&&(b+="<tr>\n"),b+=' <td rowspan=4 scope="row"><p1>'+a.objGSZP_BZ.arrObj_GSZP[c].arrObj[d].bz+"</p1></td><!--二级项目-->\n"+'    <td class="min_item"><p1>'+a.objGSZP_BZ.arrObj_GSZP[c].arrObj[d].a+"</p1></td>\n"+"    <td rowspan="+4+' scope="row"><input name="#" id="'+e+'" value = "'+a.arrDF[c][d]+'"></td>\n'+"   </tr>\n"+'   <tr><td class="min_item"><p1>'+a.objGSZP_BZ.arrObj_GSZP[c].arrObj[d].b+"</p1></td></tr>\n"+'   <tr><td class="min_item"><p1>'+a.objGSZP_BZ.arrObj_GSZP[c].arrObj[d].c+"</p1></td></tr>\n"+'   <tr><td class="min_item"><p1>'+a.objGSZP_BZ.arrObj_GSZP[c].arrObj[d].d+"</p1></td></tr>\n",b+=d!=a.objGSZP_BZ.arrObj_GSZP[c].arrObj.length-1?'<tr><td class="blankline" colspan="3" scope="col"></td></tr><!--空行-->\n':'<tr><td class="blankline" colspan="4" scope="col"></td></tr><!--空行-->\n';for(b+='<tr><td colspan="3" scope="col">总分</td> <td id="zongfen" class="total_score">'+a.zongfen+"</td></tr>\n"+"    </table>\n",b+='   <h3>自我评价部分</h3>\n     <p class="fill_in_tips">\n      <span class="fill_part">填写指引：</span>请总结本月的工作情况，评价自己的工作状态，说出收获，反映遇到的问题以及和部门内其他人相处的感受，我们会反馈给部长级\n     </p>\n     <textarea id="ziwopingjia" class="perf_textarea" name="#" rows="4" cols="50">'+a.zwpj+"</textarea> \n"+"     <h3>推优部分</h3>\n"+'     <p class="fill_in_tips">\n'+'      <span class="fill_part">填写指引：</span>请推举一名除自己以外你觉得本月表现最突出的干事，并说明理由，理由会反馈给该干事\n'+"     </p>\n"+"     <p>\n"+"      姓名：\n"+"      <!--同部门的干事-->\n"+'      <select name="#" id="tuiyou">\n'+"      </select>\n"+"     </p>\n"+"     <p>\n"+"      理由：\n"+'      <input id="tuiyouliyou" class="perf_textarea" type="text" name="#" size="80" />\n'+"     <h3>部长评价部分</h3>\n"+'     <p class="fill_in_tips">\n'+'      <span class="fill_part">填写指引：</span>请你为部长的综合表现打分(满分10分)及填写评价，评价会以匿名形式反馈给该部长\n'+"     </p>\n"+'     <table class="erjibiao" id="bzpj">\n'+"      <tr><td>姓名</td><td>分数</td><td>对部长的评价</td>\n"+"      <!--正部应该拍前面-->\n"+"     </table>\n"+"     <h3>部门留言板</h3>\n"+'     <p class="fill_in_tips">\n'+'      <span class="fill_part">填写指引：</span>请你为部门的整体情况表述意见或建议,匿名形式反馈给部长级\n'+"     </p>\n"+'     <textarea id="bumenliuyan" class="perf_textarea" name="#" rows="4" cols="50">'+a.bumenliuyan+"</textarea> \n"+"      <h3>同事留言板</h3>\n"+'     <p class="fill_in_tips">\n'+'      <span class="fill_part">填写指引：</span>你可对你因其工作态度或工作情况不满的干事提出自己的想法，会以匿名形式反馈给该干事\n'+"     </p>\n"+'     <div id="liuyanban"></div>'+'     <button type="button" id="add_a_words" title="添加" class="perf_button">﹢</button>'+"     <!--预留报错位-->\n"+"     <div></div>\n"+'     <input type="button" value="提交" id="submit"  class="perf_button" />\n'+'      <input type="button" value="保存" id="save"  class="perf_button" />\n'+"    </form>\n",GetObjById("show_more").innerHTML=b,h(),g(),GetObjById("add_a_words").onclick=function(){var c,d;return new String,c=a.arrTongshiliuyan.length,c+1>a.arrTongShi.length?(alert("你的同事总共才"+a.arrTongShi.length+"人，你加那么多干嘛- -"),!1):(d={account:a.arrTongShi[0].account,liuyan:""},a.arrTongshiliuyan.push(d),h(),g(),void 0)},GetObjById("bumenliuyan").onchange=function(){CheckLegalStr(this.value)?a.bumenliuyan=this.value:(alert("您输入有非法字段，请重新输入"),this.value=a.bumenliuyan)},i="<tr><td>姓名</td><td>分数</td><td>对部长的评价</td>\n",c=0;c<a.arrDBZPJ.length;++c)j="fenshu_"+c,k="pingjia_"+c,i+="<tr><td>"+a.arrDBZPJ[c].name+'</td><td class="normal_input"><input id='+j+' type="text" size="5" class="perf_textarea"/></td><td class="normal_input"><input id='+k+' type="text" size="80" class="perf_textarea" /></td></tr>\n';if(GetObjById("bzpj").innerHTML=i,0==a.status){for(c=0;c<a.objGSZP_BZ.arrObj_GSZP.length;++c)for(d=0;d<a.objGSZP_BZ.arrObj_GSZP[c].arrObj.length;++d)l="df_"+c+"_"+d,GetObjById(l).onchange=function(b){var d,e,c=GetId(b);this.value>=0&&this.value<=10?(d=c.split("_"),e=a.arrDF[d[1]][d[2]],a.arrDF[d[1]][d[2]]=this.value,a.zongfen=parseInt(a.zongfen)-parseInt(e)+parseInt(this.value),GetObjById("zongfen").innerHTML=a.zongfen):(this.value="",alert("*得分不能大于10或小于0，请重新填！"))},GetObjById(l).onfocus=function(){this.style.backgroundColor="white",this.style.color="#79c0be"},GetObjById(l).onblur=function(){this.style.backgroundColor="#79c0be",this.style.color="white"};for(GetObjById("ziwopingjia").onchange=function(){CheckLegalStr(this.value)?a.zwpj=this.value:(alert("您输入有非法字段，请重新输入"),a.zwpj="",this.value="")},GetObjById("tuiyou").options.length=0,m=0,c=0;c<a.arrTongShi.length;++c)GetObjById("tuiyou").options[c]=new Option(a.arrTongShi[c].name),a.TYGS.tygs==a.arrTongShi[c].name&&(m=c);for(GetObjById("tuiyou").selectedIndex=m,GetObjById("tuiyouliyou").value=a.TYGS.tyly,GetObjById("tuiyou").onchange=function(){GetObjById("tuiyouliyou").value=this.selectedIndex!=m?"请填写......":a.TYGS.tyly,a.TYGS.tygs=this.options[this.selectedIndex].text,a.TYGS.account=a.arrTongShi[this.selectedIndex].account},GetObjById("tuiyouliyou").onchange=function(){CheckLegalStr(this.value)?a.TYGS.tyly=this.value:(alert("您输入有非法字段，请重新输入"),a.TYGS.tyly="",this.value="")},d=0;d<a.arrDBZPJ.length;++d)j="fenshu_"+d,k="pingjia_"+d,GetObjById(j).value=a.arrDBZPJ[d].fs,GetObjById(k).value=a.arrDBZPJ[d].pj,GetObjById(j).onchange=function(b){var c=GetId(b),d=c.split("_");this.value>=0&&this.value<=10?a.arrDBZPJ[d[1]].fs=this.value:(this.value="",alert("*得分不能大于10或小于0，请重新填！"))},GetObjById(k).onchange=function(b){var c=GetId(b),d=c.split("_");CheckLegalStr(this.value)?a.arrDBZPJ[d[1]].pj=this.value:(alert("您输入有非法字段，请重新输入"),a.arrDBZPJ[d[1]].pj="",this.value="")};GetObjById("save").onclick=function(){n()?Post_GSZP(a)?(alert("保存成功！"),GetObjById("show_more").innerHTML=""):alert("*保存失败，请重试"):alert("保存前不允许留有空白")},GetObjById("submit").onclick=function(){o()&&(a.hadSubmit=1,Post_GSZP(a)?(alert("提交成功"),GetObjById("show_more").innerHTML=""):alert("*提交失败，请重试"))}}else{for(c=0;c<a.objGSZP_BZ.arrObj_GSZP.length;++c)for(d=0;d<a.objGSZP_BZ.arrObj_GSZP[c].arrObj.length;++d)l="df_"+c+"_"+d,GetObjById(l).value=a.arrDF[c][d],GetObjById(l).readOnly=!0;for(GetObjById("ziwopingjia").value=a.zwpj,GetObjById("ziwopingjia").readOnly=!0,GetObjById("tuiyou").options.length=0,GetObjById("tuiyou").options[0]=new Option(a.TYGS.tygs),GetObjById("tuiyouliyou").value=a.TYGS.tyly,GetObjById("tuiyouliyou").readOnly=!0,d=0;d<a.arrDBZPJ.length;++d)j="fenshu_"+d,k="pingjia_"+d,GetObjById(j).value=a.arrDBZPJ[d].fs,GetObjById(j).readOnly=!0,GetObjById(k).value=a.arrDBZPJ[d].pj,GetObjById(k).readOnly=!0;GetObjById("submit").value="确定",GetObjById("save").remove(),GetObjById("submit").onclick=function(){GetObjById("show_more").innerHTML=""}}}function Show_GSKHFK(){var c,a=Get_GSKHFK(),b="";for(b+="<h3>得分部分</h3>\n    <p>总分："+a.zongfen+"</p>\n"+"    <p>该月排名："+a.paiming+"</p>\n"+"    <p>该月优秀干事："+a.yxgs+"</p>\n"+"    <p>所在部门该月得分："+a.bmdf+"</p>"+"    <p>所在部门该月排名："+a.bmpm+"</p>"+'    <p class="fill_in_tips">\n'+'     <span class="fill_part">得分细节</span>\n'+"    </p>\n"+'    <table class="yijibiao">\n'+"     <tr>\n"+"      <td>项目</td><td>细则</td><td>得分/加减分</td><td>备注</td>\n"+"     </tr>\n"+"    <tr>\n"+"     <td>干事自评表得分</td><td>满分2分</td><td>"+a.arrDFXZ[0]+"</td><td></td>\n"+"    </tr>\n"+"    <tr>\n"+"     <td>干事考核表得分</td><td>满分5分</td><td>"+a.arrDFXZ[1]+"</td><td></td>\n"+"    </tr>\n"+"    <tr>\n"+"     <td>出勤得分</td><td><p>基本得分1分</p><p>A.例会 大会 拓展（请假-0.1/次，迟到-0.2/次，缺席-0.3/次）</p><p>B.外调（缺席-0.1/次）</p></td><td>"+a.arrDFXZ[2]+"</td><td></td>\n"+"    </tr>\n"+"    <tr>\n"+"     <td>外调加分</td><td><p>基本分0分</p><p>A.例会 大会 拓展（请假-0.1/次，迟到-0.2/次，缺席-0.3/次）</p><p>B.外调（缺席-0.1/次）</p></td><td>"+a.arrDFXZ[3]+"</td><td><p>此外调统计包括人力平时外调各部门干事，司仪、礼仪队的外调，信编拍照外调和人力观察员外调</p></td>\n"+"    </tr>\n"+"    <tr>\n"+"     <td>推优加分</td><td>0.1/票</td><td>"+a.arrDFXZ[4]+"</td><td></td>\n"+"    </tr>\n"+"    <tr>\n"+"     <td>反馈加分</td><td><p>0.1/次</p><p>在外调反馈表或活动调研问卷中写的意见被活动部门采纳</p></td><td>"+a.arrDFXZ[5]+"</td><td></td>\n"+"    </tr>\n"+"    <tr>\n"+"     <td>其他</td><td></td><td>"+a.arrDFXZ[6]+"</td><td></td>\n"+"    </tr>\n"+"   </table>\n",b+='<h3>评价部分</h3>\n    <p class="fill_in_tips">自我评价</p>\n    <div id="assessment">\n    <div id="assessment">\n     <ul>\n      <li><p class="self-assessment">'+a.zwpj+"</p></li>\n"+"     </ul>\n"+"    </div>\n"+"    </div>\n"+'    <p class="fill_in_tips">其他干事评价</p>\n'+'    <ul id="entrusted_assessment">\n',c=0;c<a.qtgspj.length;++c)b+="<li>"+a.qtgspj[c]+"</li>\n";for(b+='</ul>\n    <p class="fill_in_tips">部长级评价</p>\n    <ul id="ministerial">\n',c=0;c<a.bzpj.length;++c)b+="<li>"+a.bzpj[c]+"</li>\n";for(b+="</ul>\n",b+='<h3>留言部分</h3><p class="fill_in_tips">同事留言:放弃吧，数据库也不知道是谁留的</p>\n<ul>',c=0;c<a.liuyan.length;c++)b+="<li>"+TranStr_Get(a.liuyan[c].liuyan)+"</li>";b+='</ul><input type="button" value="确定" id="submit"  class="perf_button" />\n',GetObjById("show_more").innerHTML=b,GetObjById("submit").onclick=function(){GetObjById("show_more").innerHTML=""}}function Show_GJBMCQTJ(){function f(){var b,c,d;for(b=0;b<a.renshu;++b)for(c=1;4>c;++c)if(d="cq_"+b+"_"+c,""==GetObjById(d))return!1;return!0}var c,d,e,a=Get_GJBMCQTJ(),b="";for(b+="<h3>跟进部门："+arrDepartName[a.gjbm-1]+"</h3>\n"+"    <h3>人数："+a.renshu+"</h3>\n"+'    <form method="post" action="#">\n'+'     <table class="erjibiao">\n'+"      <tr><td>姓名</td><td>请假次数</td><td>迟到或早退次数</td><td>无辜缺席次数</td>\n",c=0;c<a.renshu;++c)b+="<tr>\n       <td>"+a.chuqin[c][0]+"</td>\n"+'       <td class="normal_input"><input class="perf_textarea" name="#" type="text" id=cq_'+c+"_1"+' value="'+a.chuqin[c][1]+'" /></td>\n'+'       <td class="normal_input"><input class="perf_textarea" name="#" type="text" id=cq_'+c+"_2"+' value="'+a.chuqin[c][2]+'" /></td>\n'+'       <td class="normal_input"><input class="perf_textarea" name="#" type="text" id=cq_'+c+"_3"+' value="'+a.chuqin[c][3]+'" /></td>\n'+"      </tr>\n";if(b+='</table>\n     <input type="button" value="提交" id="submit"  class="perf_button" />\n    </form>\n',GetObjById("show_more").innerHTML=b,0==a.status){for(c=0;c<a.renshu;++c)for(d=1;4>d;++d)e="cq_"+c+"_"+d,GetObjById(e).onchange=function(b){e=GetId(b);var c=e.split("_");""==this.value&&(this.value="0"),CheckLegalStr(this.value)?a.chuqin[c[1]][c[2]]=this.value:(alert("您输入有非法字段，请重新输入"),a.chuqin[c[1]][c[2]]="",this.value="0")};GetObjById("submit").onclick=function(){f()?Post_GJBMCQTJ(a)?(alert("提交成功！"),GetObjById("show_more").innerHTML=""):alert("*提交失败，请再提交"):alert("您还未完成，请填完再提交")}}else{for(c=0;c<a.renshu;++c)for(d=1;4>d;++d)e="cq_"+c+"_"+d,GetObjById(e).value=a.chuqin[c][d],GetObjById(e).readOnly=!0;GetObjById("submit").value="确定",GetObjById("submit").onclick=function(){GetObjById("show_more").innerHTML=""}}}function Show_DYYJCN(){function f(){var b,c,d;for(b=0;b<a.arrObjBM.length;++b)for(c=0;c<a.arrObjBM[b].arrObjCNJF.length;++c)if(d="cnjf_"+b+"_"+c,""==GetObjById(d).value)return!1;return!0}var c,d,e,a=Get_DYYJCN(),b="";for(b+='<form method="post" action="#">\n',c=0;c<a.arrObjBM.length;++c){for(b+="<h3>"+arrDepartName[a.arrObjBM[c].bmmz-1]+"</h3>\n"+'     <table class="erjibiao">\n'+"      <tr><td>用户名</td><td>采纳次数</td><td>用户名</td><td>采纳次数</td><td>用户名</td><td>采纳次数</td>\n",d=0;d<a.arrObjBM[c].arrObjCNJF.length;++d)e="cnjf_"+c+"_"+d,b+="<tr>\n <td>"+a.arrObjBM[c].arrObjCNJF[d].name+'</td><td class="normal_input"><input id='+e+' class="perf_textarea" name="#" type="text" value="'+a.arrObjBM[c].arrObjCNJF[d].jiafen+'" /></td>\n',++d,d<a.arrObjBM[c].arrObjCNJF.length?(e="cnjf_"+c+"_"+d,b+="<td>"+a.arrObjBM[c].arrObjCNJF[d].name+'</td><td class="normal_input"><input id='+e+' class="perf_textarea" name="#" type="text" value="'+a.arrObjBM[c].arrObjCNJF[d].jiafen+'" /></td>\n'):b+='<td></td><td class="normal_input"><input id='+e+' class="perf_textarea" name="#" type="text" value=" "/></td>\n',++d,d<a.arrObjBM[c].arrObjCNJF.length?(e="cnjf_"+c+"_"+d,b+="<td>"+a.arrObjBM[c].arrObjCNJF[d].name+'</td><td class="normal_input"><input id='+e+' class="perf_textarea" name="#" type="text" value="'+a.arrObjBM[c].arrObjCNJF[d].jiafen+'" /></td>\n'):b+='<td></td><td class="normal_input"><input id='+e+' class="perf_textarea" name="#" type="text" value=" "/></td>\n',b+="</tr>\n";
b+="</table>\n"}if(b+='<input type="button" value="提交" id="submit"  class="perf_button" />\n</form>\n',GetObjById("show_more").innerHTML=b,0==a.status){for(c=0;c<a.arrObjBM.length;++c)for(d=0;d<a.arrObjBM[c].arrObjCNJF.length;++d)e="cnjf_"+c+"_"+d,GetObjById(e).onchange=function(b){e=GetId(b);var c=e.split("_");a.arrObjBM[c[1]].arrObjCNJF[c[2]].jiafen=this.value};GetObjById("submit").onclick=function(){f()?Post_DYYJCN(a)?(alert("提交成功！"),GetObjById("show_more").innerHTML=""):alert("*提交失败，请再提交"):alert("您还未完成，请填完再提交")}}else{for(c=0;c<a.arrObjBM.length;++c)for(d=0;d<a.arrObjBM[c].arrObjCNJF.length;++d)e="cnjf_"+c+"_"+d,GetObjById(e).value=a.arrObjBM[c].arrObjCNJF[d].jiafen,GetObjById(e).readOnly=!0;GetObjById("submit").value="确定",GetObjById("submit").onclick=function(){GetObjById("show_more").innerHTML=""}}}function Show_ZTKHJGFK(){var c,d,a=Get_ZTKHJGFK(),b="";for(b+='<p class="fill_in_tips">优秀部门</p>\n <ol>\n',c=0;c<a.arrObjYXBM.length;++c)b+="<li>"+a.arrObjYXBM[c].bm+" &emsp;<span>得分：</span>"+a.arrObjYXBM[c].df+"</li>\n";for(b+="</ol>\n",b+='<p class="fill_in_tips">优秀部长</p>\n <ol>\n',c=0;c<a.arrObjYXBZ.length;++c)b+="<li>"+a.arrObjYXBZ[c].bzmz+"&emsp;<span>所属部门：</span>"+a.arrObjYXBZ[c].ssbm+"&emsp;<span>得分：</span>"+a.arrObjYXBZ[c].df+"</li>\n";for(b+="</ol>\n",b+='<p class="fill_in_tips">各部门优秀干事</p>\n <ul>\n',c=0;c<a.arrObjYXGS.length;++c){for(b+="<li><span>"+a.arrObjYXGS[c].bm+"</span>&emsp;\n"+"  <ol>\n",d=0;d<a.arrObjYXGS[c].arrObjGBMYXGS.length;++d)b+="<li>"+a.arrObjYXGS[c].arrObjGBMYXGS[d].name+"&emsp;<span>得分：</span>"+a.arrObjYXGS[c].arrObjGBMYXGS[d].df+"&emsp;<span>"+a.arrObjYXGS[c].arrObjGBMYXGS[d].ydyxgs+"</span></li>\n";b+="</ol>\n</li>\n"}for(b+="</ul>\n",b+='<p class="fill_in_tips">各部门外调较多人员</p>\n <ul>\n',c=0;c<a.arrObjWDJDRY.length;++c){for(b+="<li><span>"+a.arrObjWDJDRY[c].bm+"</span>&emsp;\n"+"  <ol>\n",d=0;d<a.arrObjWDJDRY[c].arrObjGBMWDJDRY.length;++d)a.arrObjWDJDRY[c].arrObjGBMWDJDRY[d].wdcs>=3&&(b+="<li>"+a.arrObjWDJDRY[c].arrObjGBMWDJDRY[d].name+"&emsp;<span>外调次数：</span>"+a.arrObjWDJDRY[c].arrObjGBMWDJDRY[d].wdcs+"</li>\n");b+="</ol>\n</li>\n"}b+="</ul>\n",b+='<input type="button" value="确定" id="submit"  class="perf_button" />\n',GetObjById("show_more").innerHTML=b,GetObjById("submit").onclick=function(){GetObjById("show_more").innerHTML=""}}function Show_BZZP(){function g(){strID=this.id,strIndex=strID.replace("delete_liuyan_",""),b.arrTSLY.splice(strIndex,1),i(),h()}function h(){var a;for(a=0;a<b.arrTSLY.length;a++)GetObjById("liuyan_"+a).value=b.arrTSLY[a].liuyan;for(a=0;a<b.arrTSLY.length;a++)GetObjById("delete_liuyan_"+a).onclick=g,GetObjById("liuyanban_"+a).onchange=function(){strID=this.id,strIndex=strID.replace("liuyanban_",""),b.arrTSLY[strIndex].account=this.value,GetObjById("liuyan_"+strIndex).value="",b.arrTSLY[strIndex].liuyan=""},GetObjById("liuyan_"+a).onchange=function(){return strID=this.id,strIndex=strID.replace("liuyan_",""),CheckLegalStr(this.value)?(b.arrTSLY[strIndex].liuyan=this.value,void 0):(alert("您的输入含有非法字段，请重新输入!"),this.value=b.arrTSLY[strIndex].liuyan,!1)}}function i(){var c,d,a=new String;for(c=0;c<b.arrTSLY.length;c++){for(a+='<select id="liuyanban_'+c+'">',d=0;d<b.arrTongShi.length;d++)a+='<option value="'+b.arrTongShi[d].account+'"',b.arrTSLY[c].account==b.arrTongShi[d].account&&(a+='selected="selected"'),a+=">"+b.arrTongShi[d].name+"</option>";a+='</select><input type="text" size="80" class="perf_textarea" id="liuyan_'+c+'"/><span class="onclick" id="delete_liuyan_'+c+'">删除</span><br />'}GetObjById("liuyanban").innerHTML=a}function p(){var c,d,e,f,g;for(c=0;c<a.arrObj_BZZP.length;++c)for(d=0;d<a.arrObj_BZZP[c].arrObj.length;++d)if(e="df_"+c+"_"+d,""==GetObjById(e))return!1;if(""==GetObjById("ziwopingjia").value)return!1;for(d=0;d<b.arrDQTBZPJ.length;++d)if(f="fenshu_"+d,g="pingjia_"+d,""==GetObjById(f).value||""==GetObjById(g).value)return!1;return""==GetObjById("dzgfzxpj").value?!1:!0}function q(){var a,c;if(!p())return alert("提交前不允许留有空白"),!1;for(a=0;a<b.arrDF.length;++a)for(c=0;c<b.arrDF[a].length;++c)if(0==b.arrDF[a][c])return alert("您的第"+(a+1)+"项，第"+(c+1)+"小项自评为0，但是我们是不允许0分的，请修改"),!1;if((""==b.zwpj||" "==b.zwpj||"无"==b.zwpj||"请填写....."==b.zwpj)&&!confirm("您的自我评价还没写，你确定要提交？"))return!1;for(a=0;a<b.arrDQTBZPJ.length;++a){if(0==b.arrDQTBZPJ[a].fs&&!confirm("您对"+b.arrDQTBZPJ[a].name+"的评分为0,你确定这样提交？"))return!1;if((""==b.arrDQTBZPJ[a].pj||" "==b.arrDQTBZPJ[a].pj||"无"==b.arrDQTBZPJ[a].pj)&&!confirm("您对"+b.arrDQTBZPJ[a].name+"的评价未填,你确定这样提交？"))return!1}return!0}var d,e,f,j,k,l,m,n,o,a=BZZP_BZ(),b=Get_BZZP(),c="";for(c+='<h3>自我评分部分</h3>\n   <p class="fill_in_tips">\n    <span class="till_part">填写指引：</span>满分10分，A项对应9-10分，B项对应7-8分，C项对应5-6分，D项对应3-4分，请按照自己的真实情况自评\n   </p>\n   <form method="post" action="#">\n    <table class="yijibiao">\n     <tr>\n      <td colspan="2" scope="col">考核项目</td><td>评价标准</td><td>得分</td>\n     </tr>\n     <tr><td class="blankline" colspan="4" scope="col"></td></tr><!--空行-->\n',d=0;d<a.arrObj_BZZP.length;++d)for(c+="<tr>\n    <td rowspan="+a.arrObj_BZZP[d].rowspan+' scope="row">'+a.arrObj_BZZP[d].xm+"</td><!--一级项目-->\n",e=0;e<a.arrObj_BZZP[d].arrObj.length;++e)f="df_"+d+"_"+e,0!=e&&(c+="<tr>\n"),c+=' <td rowspan=4 scope="row"><p1>'+a.arrObj_BZZP[d].arrObj[e].bz+"</p1></td><!--二级项目-->\n"+'    <td class="min_item"><p1>'+a.arrObj_BZZP[d].arrObj[e].a+"</p1></td>\n"+"    <td rowspan="+4+' scope="row"><input name="#" id='+f+' value="'+b.arrDF[d][e]+'"></td>\n'+"   </tr>\n"+'   <tr><td class="min_item"><p1>'+a.arrObj_BZZP[d].arrObj[e].b+"</p1></td></tr>\n"+'   <tr><td class="min_item"><p1>'+a.arrObj_BZZP[d].arrObj[e].c+"</p1></td></tr>\n"+'   <tr><td class="min_item"><p1>'+a.arrObj_BZZP[d].arrObj[e].d+"</p1></td></tr>\n",c+=e!=a.arrObj_BZZP[d].arrObj.length-1?'<tr><td class="blankline" colspan="3" scope="col"></td></tr><!--空行-->\n':'<tr><td class="blankline" colspan="4" scope="col"></td></tr><!--空行-->\n';for(c+='<tr><td colspan="3" scope="col">总分</td> <td id="zongfen" class="total_score">'+b.zongfen+"</td></tr>\n"+"   </table>\n",c+='   <h3>自我评价部分</h3>\n     <p class="fill_in_tips">\n      <span class="fill_part">填写指引：</span>请总结本月的工作情况，评价自己的工作状态，说出收获，反映遇到的问题以及和部门内其他人相处的感受，我们会反馈给主管副主席\n     </p>\n     <textarea id="ziwopingjia" class="perf_textarea" name="#" rows="4" cols="50">'+b.zwpj+"</textarea> \n"+"     <h3>对本部门其他部长级打分及评价部分</h3>\n"+'     <p class="fill_in_tips">\n'+'      <span class="fill_part">填写指引：</span>请对本部门其他部长级的综合表现打分，满分10分，并且填写评价，我们会把评价反馈给该部长级\n'+"     </p>\n"+'     <table class="erjibiao" id="bzpj">\n'+"      <tr><td>姓名</td><td>分数</td><td>对部长的评价</td>\n"+"      <!--正部应该拍前面-->\n"+"     </table>\n"+"     <h3>对主管副主席评价部分</h3>\n"+'     <p class="fill_in_tips">\n'+'      <span class="fill_part">对主管副主席评价部分:</span>请填写对主管副主席的意见或建议，我们会反馈给主管副主席\n'+"     </p>\n"+'      <textarea id="dzgfzxpj" class="perf_textarea" name="#" rows="4" cols="50">'+b.dzgfzxpj+"</textarea>\n",c+='    <h3>对主席团的匿名评价部分</h3>\n     <p class="fill_in_tips">\n      <span class="fill_part">填写指引：</span>此处非必填，你可以对主席团的任意成员评价，我们会匿名反馈给该主席团成员\n     </p>\n     <table class="erjibiao" id="nmpj">\n      <tr><td>姓名</td><td>职位</td><td>匿名评价</td>\n      <!--正部应该拍前面-->\n      <tr><td>主席1</td><td>副主席</td><td class="normal_input"><input id="pingjia3" type="text" size="80" class="perf_textarea" /></td></tr>\n     </table>\n     <h3>对其他部门部长级的留言板</h3>\n     <p class="fill_in_tips">\n      <span class="fill_part">填写指引：</span>请对其他部门部长级以及部门工作的综合表填写建议或意见，我们会把评价反馈给该部长级\n     </p>\n     <div id="liuyanban"></div>     <button type="button" id="add_a_words" title="添加" class="perf_button">﹢</button>     <!--预留报错位-->\n     <div></div>\n     <input type="button" value="提交" id="submit"  class="perf_button" />\n      <input type="button" value="保存" id="save"  class="perf_button" />\n    </form>\n',GetObjById("show_more").innerHTML=c,i(),h(),GetObjById("add_a_words").onclick=function(){var c,d;return new String,c=b.arrTSLY.length,c+1>b.arrTongShi.length?(alert("你的同事总共才"+b.arrTongShi.length+"人，你加那么多干嘛- -"),!1):(d={account:b.arrTongShi[0].account,liuyan:""},""==b.arrTSLY&&(b.arrTSLY=new Array),console.log(b.arrTSLY),b.arrTSLY.push(d),i(),h(),void 0)},j="<tr><td>姓名</td><td>分数</td><td>对部长的评价</td>\n",d=0;d<b.arrDQTBZPJ.length;++d)k="fenshu_"+d,l="pingjia_"+d,j+="<tr><td>"+b.arrDQTBZPJ[d].name+'</td><td class="normal_input"><input id='+k+' type="text" size="5" class="perf_textarea"/></td><td class="normal_input"><input id='+l+' type="text" size="80" class="perf_textarea" /></td></tr>\n';for(GetObjById("bzpj").innerHTML=j,m="<tr><td>姓名</td><td>职位</td><td>匿名评价</td>\n",d=0;d<b.arrNMPJ.length;++d)m+="<tr><td>"+b.arrNMPJ[d].name+"</td><td>"+b.arrNMPJ[d].depart+'</td><td class="normal_input"><input id='+("nmpj_"+d)+' type="text" size="80" class="perf_textarea" /></td></tr>\n';if(GetObjById("nmpj").innerHTML=m,0==b.status){for(d=0;d<a.arrObj_BZZP.length;++d)for(e=0;e<a.arrObj_BZZP[d].arrObj.length;++e)n="df_"+d+"_"+e,GetObjById(n).onchange=function(a){var d,e,c=GetId(a);this.value>=0&&this.value<=10?(d=c.split("_"),e=b.arrDF[d[1]][d[2]],b.arrDF[d[1]][d[2]]=this.value,b.zongfen=parseInt(b.zongfen)-parseInt(e)+parseInt(this.value),GetObjById("zongfen").innerHTML=b.zongfen):(this.value="",alert("*得分不能大于10或小于0，请重新填！"))},GetObjById(n).onfocus=function(){this.style.backgroundColor="white",this.style.color="#79c0be"},GetObjById(n).onblur=function(){this.style.backgroundColor="#79c0be",this.style.color="white"};for(GetObjById("ziwopingjia").onchange=function(){CheckLegalStr(this.value)?b.zwpj=this.value:(alert("您输入有非法字段，请重新输入"),b.zwpj="",this.value="")},e=0;e<b.arrDQTBZPJ.length;++e)k="fenshu_"+e,l="pingjia_"+e,GetObjById(k).value=b.arrDQTBZPJ[e].fs,GetObjById(l).value=b.arrDQTBZPJ[e].pj,GetObjById(k).onchange=function(a){var c=GetId(a),d=c.split("_");this.value>=0&&this.value<=10?b.arrDQTBZPJ[d[1]].fs=this.value:(this.value="",alert("*得分不能大于10或小于0，请重新填！"))},GetObjById(l).onchange=function(a){var c=GetId(a),d=c.split("_");CheckLegalStr(this.value)?b.arrDQTBZPJ[d[1]].pj=this.value:(alert("您输入有非法字段，请重新输入"),b.arrDQTBZPJ[d[1]].pj="",this.value="")};for(GetObjById("dzgfzxpj").onchange=function(){CheckLegalStr(this.value)?b.dzgfzxpj=this.value:(alert("您输入有非法字段，请重新输入"),b.dzgfzxpj="",this.value="")},d=0;d<b.arrNMPJ.length;++d)o="nmpj_"+d,GetObjById(o).value=b.arrNMPJ[d].pj,GetObjById(o).onchange=function(a){var c=GetId(a),d=c.split("_");CheckLegalStr(this.value)?b.arrNMPJ[d[1]].pj=this.value:(alert("您输入有非法字段，请重新输入"),b.arrNMPJ[d[1]].pj="",this.value="")};GetObjById("save").onclick=function(){p()?Post_BZZP(b)?(alert("保存成功！"),GetObjById("show_more").innerHTML=""):alert("*保存失败，请重试"):alert("保存前不允许留有空白")},GetObjById("submit").onclick=function(){q()&&(b.hadSubmit=1,Post_BZZP(b)?(alert("提交成功"),GetObjById("show_more").innerHTML=""):alert("*提交失败，请重试"))}}else{for(d=0;d<a.arrObj_BZZP.length;++d)for(e=0;e<a.arrObj_BZZP[d].arrObj.length;++e)n="df_"+d+"_"+e,GetObjById(n).value=b.arrDF[d][e],GetObjById(n).readOnly=!0;for(GetObjById("ziwopingjia").value=b.zwpj,GetObjById("ziwopingjia").readOnly=!0,e=0;e<b.arrDQTBZPJ.length;++e)k="fenshu_"+e,l="pingjia_"+e,GetObjById(k).value=b.arrDQTBZPJ[e].fs,GetObjById(k).readOnly=!0,GetObjById(l).value=b.arrDQTBZPJ[e].pj,GetObjById(l).readOnly=!0;for(d=0;d<b.arrNMPJ.length;++d)o="nmpj_"+d,GetObjById(o).value=b.arrNMPJ[d].pj,GetObjById(o).readOnly=!0;GetObjById("submit").value="确定",GetObjById("save").remove(),GetObjById("submit").onclick=function(){GetObjById("show_more").innerHTML=""}}}function Show_GSKH(){function e(b){var d,c=0;for(d=0;8>d;d++)c+=parseFloat(a.arrGSDF[b]["df"+d]);return c=5*(c/80)}function g(){var b,c,d;for(b=0;b<a.arrGSDF.length;++b)for(c=0;8>c;++c)if(d="bzId_"+b+"_"+c,""==GetObjById(d).value)return!1;for(b=0;b<a.arrDGSPJ.length;++b)if(d="pj_"+b,""==GetObjById(d).value)return!1;return!0}function h(){var b,c;for(b=0;b<a.arrGSDF.length;++b){for(c=0;8>c;++c)if(0==a.arrGSDF[b]["df"+c])return alert(a.arrGSDF[b].name+"的第"+(c+1)+"项得分为0，必须填写才能提交"),!1;if(("无"==a.arrDGSPJ[b].pj||""==a.arrDGSPJ[b].pj||" "==a.arrDGSPJ[b].pj)&&!confirm(a.arrDGSPJ[b].name+"的评价还没写，你确定这样提交？"))return!1}return!0}var c,d,f,a=Get_GSKH(),b='<div id="pjbz"></div>';for(b+='<h3>评分部分</h3><p class="fill_in_tips"><span class="till_part">考核干事部分:</span>满分10分，A项对应9-10分，B项对应7-8分，C项对应5-6分，D项对应3-4分，请为干事评分</p><form method="post" action="#"><table class="erjibiao ganshikaohebiao"><tr><td class="blankline" colspan="6" scope="col"></td></tr><tr><td></td><td colspan="5" scope="col">工作情况</td></tr><tr><td></td><td>工作量</td><td>工作效率</td><td>工作质量</td><td>工作态度</td><td>工作能力</td></tr>',c=0;c<a.arrGSDF.length;++c){for(b+="<tr><td>"+a.arrGSDF[c].name+"</td>",d=0;5>d;++d)b+='<td class="normal_input"><input class="perf_textarea" name="#" type="text" value="'+a.arrGSDF[c]["df"+d]+'" id ='+("bzId_"+c+"_"+d)+' size="16"/></td>';b+="</tr>"}for(b+=' <tr>  <td class="blankline" colspan="8" scope="col"></td> </tr>',b+='<tr><td></td><td colspan="3" scope="col">工作情况</td><td colspan="1" scope="col">总分(5分制)</td></tr><tr><td></td><td>合作能力</td><td>表达能力</td><td>团队精神</td><td>总分</td></tr>',c=0;c<a.arrGSDF.length;++c){for(b+="<tr><td>"+a.arrGSDF[c].name+"</td>",d=5;8>d;++d)b+='<td class="normal_input"><input class="perf_textarea" name="#" type="text" value="'+a.arrGSDF[c]["df"+d]+'" id ='+("bzId_"+c+"_"+d)+' size="16"/></td>';b+='<td id="zdf_'+c+'">'+e(c)+"</td>",b+="</tr>"}for(b+="</table>",b+='<h3>评价干事部分</h3><p class="fill_in_tips"><span class="till_part">评价干事:</span>根据您对干事的观察与了解，您认为该干事在本时段的工作中哪些地方最让你欣赏或者是哪些地方还需要改进的，请给该干事一个整体的评价和发展建议。</p><table class="erjibiao"><tr><td>姓名</td><td>对干事的评价</td>',c=0;c<a.arrDGSPJ.length;++c)b+="<tr><td>"+a.arrDGSPJ[c].name+'</td><td class="normal_input"><input id='+("pj_"+c)+' type="text" size="100" class="perf_textarea" value="'+a.arrDGSPJ[c].pj+'" /></td></tr>';for(b+="</table>",b+='<!--预留报错位-->\n <div></div>\n<input type="button" value="提交" id="submit"  class="perf_button" />\n<input type="button" value="保存" id="save"  class="perf_button" />\n',b+="</form>",GetObjById("show_more").innerHTML=b,c=0;c<a.arrGSDF.length;++c)for(d=0;8>d;++d)f="bzId_"+c+"_"+d,GetObjById(f).onfocus=function(b){var d,c=new Array(400,550,700,800,400,550,700);f=GetId(b),d=f.split("_"),GetObjById("pjbz").style.left=c[d[2]%5]+"px",GetObjById("pjbz").innerHTML=13==d[2]?a.bmts:a.GSKH_BZ["str"+d[2]]},GetObjById(f).onblur=function(){GetObjById("pjbz").innerHTML=""};if(0==a.status){for(c=0;c<a.arrGSDF.length;++c)for(d=0;8>d;++d)f="bzId_"+c+"_"+d,GetObjById(f).onchange=function(b){var d,c=GetId(b);this.value>=0&&this.value<=10?(c=GetId(b),d=c.split("_"),a.arrGSDF[d[1]]["df"+d[2]]=parseFloat(this.value),GetObjById("zdf_"+d[1]).innerHTML=e(d[1])):(this.value="",alert("*得分不能大于10或小于0，请重新填！"))};for(c=0;c<a.arrDGSPJ.length;++c)f="pj_"+c,GetObjById(f).onchange=function(b){f=GetId(b);var c=f.split("_");CheckLegalStr(this.value)?a.arrDGSPJ[c[1]].pj=this.value:(alert("您输入有非法字段，请重新输入"),a.arrDGSPJ[c[1]].pj="",this.value="")};GetObjById("save").onclick=function(){g()?Post_GSKH(a)?(alert("保存成功！"),GetObjById("show_more").innerHTML=""):alert("*保存失败，请重试"):alert("保存前不允许留有空白")},GetObjById("submit").onclick=function(){h()&&(a.hadSubmit=1,Post_GSKH(a)?(alert("提交成功"),GetObjById("show_more").innerHTML=""):alert("*提交失败，请重试"))}}else{for(c=0;c<a.arrGSDF.length;++c)for(d=0;8>d;++d)f="bzId_"+c+"_"+d,GetObjById(f).value=a.arrGSDF[c]["df"+d],GetObjById(f).readOnly=!0;for(c=0;c<a.arrDGSPJ.length;++c)f="pj_"+c,GetObjById(f).value=a.arrDGSPJ[c].pj,GetObjById(f).readOnly=!0;GetObjById("submit").value="确定",GetObjById("save").remove(),GetObjById("submit").onclick=function(){GetObjById("show_more").innerHTML=""}}}function Show_BZFK(){var c,a=Get_BZFK(),b=new String;for(b+="<h3>得分部分</h3>\n<p>总分："+a.ZongFen+"</p>\n"+'<p class="fill_in_tips">\n'+' <span class="fill_part">得分细节</span>\n'+"</p>\n"+'<table class="yijibiao">\n'+" <tr>\n"+"  <td>项目</td><td>细则</td><td>得分/加减分</td><td>备注</td>\n"+" </tr>\n"+" <tr>\n"+"  <td>部长自评表得分</td><td><p>满分2分<p></td><td>"+a.arrDeFenXiZhe[0]+"</td><td></td>\n"+" </tr>\n"+" <tr>\n"+"  <td>部长考核表得分</td><td><p>满分5分<p></td><td>"+a.arrDeFenXiZhe[1]+"</td><td></td>\n"+" </tr>\n"+" <tr>\n"+"  <td>干事评分</td><td><p>满分2分，干事打分为10分制，由干事打分*0.2/部门干事人数）</p></td><td>"+a.arrDeFenXiZhe[2]+"</td><td></td>\n"+" </tr>\n"+" <tr>\n"+"  <td>其他部长级评分</td><td><p>满分2分，部长打分为10分制，由部长打分*0.2/部门除该部长外部长人数）</p></td><td>"+a.arrDeFenXiZhe[3]+"</td><td></td>\n"+" </tr>\n"+" <tr>\n"+"  <td>出勤得分</td><td><p>基本得分1分</p><p>A.例会 大会 拓展（请假-0.1/次，迟到-0.2/次，缺席-0.3/次）</p><p>B.外调（缺席-0.1/次）</p></td><td>"+a.arrDeFenXiZhe[4]+"</td><td></td>\n"+" </tr>\n"+" <tr>\n"+"  <td>外调加分</td><td><p>基本分0分</p><p>A.例会 大会 拓展（请假-0.1/次，迟到-0.2/次，缺席-0.3/次）</p><p>B.外调（缺席-0.1/次）</p></td><td>"+a.arrDeFenXiZhe[5]+"</td><td><p>此外调统计包括人力平时外调各部门干事，司仪、礼仪队的外调，信编拍照外调和人力观察员外调</p></td>\n"+" </tr>\n"+" <tr>\n"+"  <td>反馈加分</td><td><p>0.1/次</p><p>在外调反馈表或活动调研问卷中写的意见被活动部门采纳</p></td><td>"+a.arrDeFenXiZhe[6]+"</td><td></td>\n"+" </tr>\n"+" <tr>\n"+"  <td>其他</td><td></td><td>"+a.arrDeFenXiZhe[7]+"</td><td></td>\n"+" </tr>\n"+"</table>\n"+"<h3>评价部分</h3>\n"+'<p class="fill_in_tips">自我评价</p>\n'+'<div id="assessment">\n'+" <ul>\n"+'  <li><p class="self-assessment">'+a.ZiWoPingJia+"</p></li>\n"+" </ul>\n"+"</div>\n"+'<p class="fill_in_tips">干事评价</p>\n'+'<ul id="entrusted_assessment">\n',c=0;c<a.arrGanShiPingJia.length;c++)b+="<li>"+a.arrGanShiPingJia[c]+"</li>";for(b+='</ul><p class="fill_in_tips">其他部长评价</p><ul class="ministerial">',c=0;c<a.arrQiTaBuZhanPinJia.length;c++)b+="<li>"+a.arrQiTaBuZhanPinJia[c]+"</li>";for(b+='</ul><p class="fill_in_tips">来自其他部门其他部长级的留言</p><ul class="ministerial">',0==a.arrLiuYan.length&&(b+="<li>木有留言</li>"),c=0;c<a.arrLiuYan.length;c++)b+="<li>"+a.arrLiuYan[c]+"</li>";for(b+='</ul><p class="fill_in_tips">主管副主席评价</p><ul class="ministerial"><li>'+a.ZhuGuanFuZhuXiPinJia+"</li>"+"</ul>"+"<h3>干事自我评价部分</h3>"+"<ul>",c=0;c<a.arrGanShiZhiWoPinJia.length;c++)b+='<li><p class="self-assessment">'+a.arrGanShiZhiWoPinJia[c].name+"<br />"+a.arrGanShiZhiWoPinJia[c].assess+"</p></li>";for(b+="</ul>",b+="<h3>干事得分排名</h3><ol>",c=0;c<a.arrGanShiDeFengPaiMing.length;c++)b+="<li>"+a.arrGanShiDeFengPaiMing[c].name+"&emsp;<span>得分：</span>"+a.arrGanShiDeFengPaiMing[c].score+"</li>";for(b+="</ol><h3>部门情况反馈</h3><p>部门得分："+a.BuMenDeFeng+"</p>"+'<p class="fill_in_tips">部门排名：</p>'+"<table>",c=0;c<a.arrBuMenPaiMing.length;c++)b+="<tr><td>"+(c+1)+". </td><td>&emsp;&emsp;"+arrDepartName[a.arrBuMenPaiMing[c].bm-1]+"</td><td><span>得分:</span>"+a.arrBuMenPaiMing[c].df+"</td></tr>";for(b+='</table><p class="fill_in_tips"><span class="fill_part">得分细节</span></p><table class="yijibiao"> <tr>  <td>项目</td><td>细则</td><td>得分/加减分</td><td>备注</td> </tr> <tr>  <td>主席评分</td><td><p>满分5分<p></td><td>'+a.arrBuMenDeFenXiZhe[0]+"</td><td></td>"+" </tr>"+" <tr>"+"  <td>主管副主席评分</td><td><p>满分3分<p></td><td>"+a.arrBuMenDeFenXiZhe[1]+"</td><td></td>"+" </tr>"+" <tr>"+"  <td>部门出勤</td><td><p>基本得分2分</p><p>A例会 大会 拓展（请假-0.1/人次，迟到-0.2/人次，缺席-0.3/人次）</p></td><td>"+a.arrBuMenDeFenXiZhe[2]+"</td><td><p>此统计还包括部长级例会的出勤情况（扣分情况与平时例会相同），外调缺席不扣部门出勤分<p></td>"+" </tr>"+" <tr>"+"  <td>违反违规惩戒制度</td><td><p>包括秘书、人力、公关、信编和宣传的违规惩戒制度，具体扣分细则请看总群群共享上的《违规惩戒制度》</p></td><td>"+a.arrBuMenDeFenXiZhe[3]+"</td><td><p>此外调统计包括人力平时外调各部门干事，司仪、礼仪队的外调，信编拍照外调和人力观察员外调</p></td>"+" </tr>"+" <tr>"+"  <td>反馈加分</td><td><p>0.1/人次</p><p>在外调反馈表或活动调研问卷中写的意见被活动部门采纳</p></td><td>"+a.arrBuMenDeFenXiZhe[4]+"</td><td></td>"+" </tr>"+" <tr>"+"  <td>主管副主席推优</td><td><p>0.3/票</p></td><td>"+a.arrBuMenDeFenXiZhe[5]+"</td><td>每位主管副主席推优一个非主管部门</td>"+" </tr>"+" <tr>"+"  <td>优秀部长加分</td><td><p>0.2</p></td><td>"+a.arrBuMenDeFenXiZhe[6]+"</td><td></td>"+" </tr>"+"  <td>其他</td><td></td><td>"+a.arrBuMenDeFenXiZhe[7]+"</td><td></td>"+" </tr>"+"</table>"+'<p class="fill_in_tips">主席的部门评价</p>'+'<ul class="ministerial">'+' <li><p class="self-assessment">'+a.ZhuXiDeBuMenPinJia+"</p></li>"+"</ul>"+'<p class="fill_in_tips">主管副主席的部门评价</p>'+'<ul class="ministerial">'+' <li><p class="self-assessment">'+a.ZhuGuanFuZhuXiBuMenPinJia+"</p></li>"+"</ul>"+'<p class="fill_in_tips">干事对部门的评价</p>'+'<ul class="ministerial">',c=0;c<a.arrBuMenLiuYan.length;c++)b+=' <li><p class="self-assessment">'+a.arrBuMenLiuYan[c]+"</p></li>";b+='</ul><button type="button" id="submit" class="perf_button">确定</button>',GetObjById("show_more").innerHTML=b,GetObjById("submit").onclick=function(){GetObjById("show_more").innerHTML=""}}function Show_BZKH(){function f(b,c){var e,d=0;for(e=0;9>e;e++)d+=parseFloat(a.arrBMBZ[b].arrBZ[c]["df"+e]);return d=5*(d/90)}function h(){var b,c,d,e;for(b=0;b<a.arrBMBZ.length;++b)for(c=0;c<a.arrBMBZ[b].arrBZ.length;++c)for(d=0;9>d;++d)if(e="df_"+b+"_"+c+"_"+d,""==GetObjById(e).value)return!1;for(b=0;b<a.arrBMBZ.length;++b)for(c=0;c<a.arrBMBZ[b].arrBZ.length;++c)if(e="pj_"+b+"_"+c,""==GetObjById(e).value)return!1;return!0}function i(){var b,c,d,e;for(b=0;b<a.arrBMBZ.length;++b)for(c=0;c<a.arrBMBZ[b].arrBZ.length;++c){for(d=0;9>d;++d)if(0==a.arrBMBZ[b].arrBZ[c]["df"+d])return alert(a.arrBMBZ[b].arrBZ[c].bzmz+"的第"+(c+1)+"项评分未填，必须填写才能提交- -"),!1;if(e=a.arrBMBZ[b].arrBZ[c].pj,("无"==e||""==e||" "==e||"请填写......"==e)&&!confirm(a.arrBMBZ[b].arrBZ[c].bzmz+"的评价未填写，您确定这样提交？"))return!1}return!0}var c,d,e,g,a=Get_BZKH(),b='<div id="pjbz"></div>';for(b+=' <h3>评分部分</h3> <p class="fill_in_tips">  <span class="till_part">考核干事部分:</span>满分10分，A项对应9-10分，B项对应7-8分，C项对应5-6分，D项对应3-4分，请为部长评分 </p> <form method="post" action="#">  <table class="erjibiao ganshikaohebiao">   <tr>    <td></td>    <td></td>    <td colspan="3" scope="col">协作能力</td>    <td colspan="2" scope="col">督导能力</td>   </tr>   <tr>    <td>部门</td>    <td>姓名</td>    <td>沟通能力</td>    <td>合作能力</td>    <td>表达能力</td>    <td>管理能力</td>    <td>领导能力</td>   </tr>',c=0;c<a.arrBMBZ.length;++c){for(d=0;d<a.arrBMBZ[c].arrBZ.length;++d)for(b+="<tr>",0==d&&(b+="<td rowspan="+a.arrBMBZ[c].arrBZ.length+' scope="row">'+a.arrBMBZ[c].bm+"</td>"),b+="<td>"+a.arrBMBZ[c].arrBZ[d].bzmz+"</td>",e=0;5>e;++e)b+='<td class="normal_input"><input id='+("df_"+c+"_"+d+"_"+e)+' class="perf_textarea" name="#" type="text" value="'+a.arrBMBZ[c].arrBZ[d]["df"+e]+'" size="16"/></td>';b+="</tr>"}for(b+=' <tr>  <td class="blankline" colspan="8" scope="col"></td> </tr> <tr>  <td></td>  <td></td>  <td colspan="4" scope="col">工作情况</td>  <td colspan="1" scope="col">总分(5分制)</td> </tr> <tr>  <td>部门</td>  <td>姓名</td>  <td>工作量</td>  <td>工作方法</td>  <td>工作态度</td>  <td>工作能力</td>  <td>总分</td> </tr>',c=0;c<a.arrBMBZ.length;++c){for(d=0;d<a.arrBMBZ[c].arrBZ.length;++d){for(b+="<tr>",0==d&&(b+="<td rowspan="+a.arrBMBZ[c].arrBZ.length+' scope="row">'+a.arrBMBZ[c].bm+"</td>"),b+="<td>"+a.arrBMBZ[c].arrBZ[d].bzmz+"</td>",e=5;9>e;++e)b+='<td class="normal_input"><input id='+("df_"+c+"_"+d+"_"+e)+' class="perf_textarea" name="#" type="text" value="'+a.arrBMBZ[c].arrBZ[d]["df"+e]+'" size="16"/></td>';b+='<td id="zdf_'+c+"_"+d+'">'+f(c,d)+"</td>"}b+="</tr>"}for(b+="</table>",b+=' <h3>评价部长部分</h3> <p class="fill_in_tips">  <span class="till_part">评价部长:</span>根据您对部长级的观察与了解，您认为该部长级在本时段的工作中哪些地方最让你欣赏或者是哪些地方还需要改进的，请给该部长级一个整体的评价和发展建议。 </p> <table class="erjibiao">  <tr><td>部门</td><td>姓名</td><td>对部长的评价</td>',c=0;c<a.arrBMBZ.length;++c)for(d=0;d<a.arrBMBZ[c].arrBZ.length;++d)b+=0==d?" <tr><td rowspan="+a.arrBMBZ[c].arrBZ.length+' scope="row">'+a.arrBMBZ[c].bm+"</td><td>"+a.arrBMBZ[c].arrBZ[d].bzmz+'</td><td class="normal_input"><input id='+("pj_"+c+"_"+d)+' value="'+a.arrBMBZ[c].arrBZ[d].pj+'" type="text" size="80" class="perf_textarea" /></td></tr>':"<tr><td>"+a.arrBMBZ[c].arrBZ[d].bzmz+'</td><td class="normal_input"><input id='+("pj_"+c+"_"+d)+' value="'+a.arrBMBZ[c].arrBZ[d].pj+'" type="text" size="80" class="perf_textarea" /></td></tr>';for(b+="</table>",b+='<!--预留报错位-->\n <div></div>\n<input type="button" value="提交" id="submit"  class="perf_button" />\n<input type="button" value="保存" id="save"  class="perf_button" />\n',b+="</form>",GetObjById("show_more").innerHTML=b,c=0;c<a.arrBMBZ.length;++c)for(d=0;d<a.arrBMBZ[c].arrBZ.length;++d)for(e=0;9>e;++e)g="df_"+c+"_"+d+"_"+e,GetObjById(g).onfocus=function(b){var d,c=new Array(450,600,750,300,450,600);g=GetId(b),d=g.split("_"),GetObjById("pjbz").style.left=c[d[3]%5]+"px",GetObjById("pjbz").innerHTML=a.BZKH_BZ["str"+d[3]]},GetObjById(g).onblur=function(){GetObjById("pjbz").innerHTML=""};if(0==a.status){for(c=0;c<a.arrBMBZ.length;++c)for(d=0;d<a.arrBMBZ[c].arrBZ.length;++d)for(e=0;9>e;++e)g="df_"+c+"_"+d+"_"+e,GetObjById(g).onchange=function(b){var d,c=GetId(b);this.value>=0&&this.value<=10?(c=GetId(b),d=c.split("_"),a.arrBMBZ[d[1]].arrBZ[d[2]]["df"+d[3]]=this.value,GetObjById("zdf_"+d[1]+"_"+d[2]).innerHTML=f(d[1],d[2])):(this.value="",alert("*得分不能大于10或小于0，请重新填！"))};for(c=0;c<a.arrBMBZ.length;++c)for(d=0;d<a.arrBMBZ[c].arrBZ.length;++d)g="pj_"+c+"_"+d,GetObjById(g).onchange=function(b){g=GetId(b);var c=g.split("_");CheckLegalStr(this.value)?a.arrBMBZ[c[1]].arrBZ[c[2]].pj=this.value:(alert("您输入有非法字段，请重新输入"),a.arrBMBZ[c[1]].arrBZ[c[2]].pj="",this.value="")};GetObjById("save").onclick=function(){h()?Post_BZKH(a)?(alert("保存成功！"),GetObjById("show_more").innerHTML=""):alert("*保存失败，请重试"):alert("保存前不允许留有空白")},GetObjById("submit").onclick=function(){i()&&(a.hadSubmit=1,Post_BZKH(a)?(alert("提交成功"),GetObjById("show_more").innerHTML=""):alert("*提交失败，请重试"))}}else{for(c=0;c<a.arrBMBZ.length;++c)for(d=0;d<a.arrBMBZ[c].arrBZ.length;++d)for(e=0;15>e;++e)g="df_"+c+"_"+d+"_"+e,GetObjById(g).value=a.arrBMBZ[c].arrBZ[d]["df"+e],GetObjById(g).readOnly=!0;for(c=0;c<a.arrBMBZ.length;++c)for(d=0;d<a.arrBMBZ[c].arrBZ.length;++d)g="pj_"+c+"_"+d,GetObjById(g).value=a.arrBMBZ[c].arrBZ[d].pj,GetObjById(g).readOnly=!0;GetObjById("submit").value="确定",GetObjById("save").remove(),GetObjById("submit").onclick=function(){GetObjById("show_more").innerHTML=""}}}function Show_BMKH(){function i(){var b,c,d;for(b=0;b<a.arrBM.length;++b)for(c=0;7>c;++c)if(d="df_"+b+"_"+c,""==GetObjById(d).value)return!1;for(b=0;b<a.arrBM.length;++b)if(d="pj_"+b,""==GetObjById(d).value)return!1;return!0}function j(){var b,c,d;for(b=0;b<a.arrBM.length;++b){for(c=0;7>c;++c)if(0==a.arrBM[b]["df"+c])return alert(a.arrBM[b].bm+"的第"+(b+1)+"项评分未填写，请填写了再提交!"),!1;if(d=a.arrBM[b].pj,(""==d||" "==d||"无"==d)&&!confirm(a.arrBM[b].bm+"的评价未填写，您确定就这样提交？"))return!1}return!0}var c,d,e,g,a=Get_BMKH(),b='<div id="pjbz"></div>';for(b+=' <h3>部门评分部分</h3> <p class="fill_in_tips">  <span class="till_part">部门评分部分：</span>满分10分，A项对应9-10分，B项对应7-8分，C项对应5-6分，D项对应3-4分，请为部长评分 </p> <form method="post" action="#">  <table class="erjibiao ganshikaohebiao">   <tr>    <td>部门</td>    <td>工作量/工作难度</td>    <td>工作完成效果</td>    <td>工作态度</td>    <td>纪律性</td>',console.log("部门考核表测试"),console.log(a.arrBM),c=0;c<a.arrBM.length;++c){for(b+=" <tr>  <td>"+a.arrBM[c].bm+"</td>",d=0;4>d;++d)b+=' <td class="normal_input"><input id='+("df_"+c+"_"+d)+' value="'+a.arrBM[c]["df"+d]+'" class="perf_textarea" name="#" type="text" value="0" size="16"/></td>';b+=" </tr>"}for(b+="<tr><td>部门</td><td>部门凝聚力</td><td>沟通合作能力</td><td>部门成员表现</td></tr>",c=0;c<a.arrBM.length;++c){for(b+="<tr><td>"+a.arrBM[c].bm+"</td>",d=4;7>d;++d)b+=' <td class="normal_input"><input id='+("df_"+c+"_"+d)+' value="'+a.arrBM[c]["df"+d]+'" class="perf_textarea" name="#" type="text" value="0" size="16"/></td>';b+="</tr>"}for(b+="</table>",b+=' <table class="erjibiao">  <tr><td>部门</td><td>对部门的评价</td>',c=0;c<a.arrBM.length;++c)b+="<tr><td>"+a.arrBM[c].bm+'</td><td class="normal_input"><input id='+("pj_"+c)+' value="'+a.arrBM[c].pj+'" type="text" size="80" class="perf_textarea" /></td></tr>';for(b+="</table>",b+='<h3>推优部分</h3>\n<p class="fill_in_tips">\n <span class="fill_part">填写指引：</span>请推选一个本月表现突出的非本人主管部门，并说明理由，理由会反馈给该部长\n</p>\n<p>\n 部门：\n <!--部门-->\n <select name="#" id="tuiyou">\n </select>\n</p>\n',b+='<!--预留报错位-->\n <div></div>\n<input type="button" value="提交" id="submit"  class="perf_button" />\n<input type="button" value="保存" id="save"  class="perf_button" />\n',b+="</form>",GetObjById("show_more").innerHTML=b,c=0;c<a.arrBM.length;++c)for(d=0;7>d;++d)e="df_"+c+"_"+d,GetObjById(e).onfocus=function(b){var d,c=new Array(580,750,880,350,390,530,660);e=GetId(b),d=e.split("_"),GetObjById("pjbz").style.left=c[d[2]%4]+"px",GetObjById("pjbz").innerHTML=a.BMKH_BZ["str"+d[2]]},GetObjById(e).onblur=function(){GetObjById("pjbz").innerHTML=""};if(0==a.status){for(c=0;c<a.arrBM.length;++c)for(d=0;7>d;++d)e="df_"+c+"_"+d,GetObjById(e).onchange=function(b){var d,c=GetId(b);this.value>=0&&this.value<=10?(c=GetId(b),d=c.split("_"),a.arrBM[d[1]]["df"+d[2]]=this.value):(this.value="",alert("*得分不能大于10或小于0，请重新填！"))};for(c=0;c<a.arrBM.length;++c)e="pj_"+c,GetObjById(e).onchange=function(b){e=GetId(b);var c=e.split("_");CheckLegalStr(this.value)?a.arrBM[c[1]].pj=this.value:(alert("您输入有非法字段，请重新输入"),a.arrBM[c[1]].pj="",this.value="")};for(GetObjById("tuiyou").options.length=0,c=0;c<a.arrBuMen.length;++c)g=arrDepartName.indexOf(a.arrBuMen[c].name)+1,$("<option></option>").val(g).html(a.arrBuMen[c].name).appendTo($("#tuiyou"));$("#tuiyou").val(a.TYBM),GetObjById("tuiyou").onchange=function(){a.TYBM=$("#tuiyou").val()},GetObjById("save").onclick=function(){i()?Post_BMKH(a)?(alert("保存成功！"),GetObjById("show_more").innerHTML=""):alert("*保存失败，请再提交"):alert("保存前不允许留有空白！")},GetObjById("submit").onclick=function(){return i()?(j()&&(a.hadSubmit=1,Post_BMKH(a)?(alert("提交成功！"),GetObjById("show_more").innerHTML=""):alert("*保存失败，请再提交")),void 0):(alert("提交前不允许留有空白！"),!1)}}else{for(c=0;c<a.arrBM.length;++c)for(d=0;7>d;++d)e="df_"+c+"_"+d,GetObjById(e).value=a.arrBM[c]["df"+d],GetObjById(e).readOnly=!0;for(c=0;c<a.arrBM.length;++c)e="pj_"+c,GetObjById(e).value=a.arrBM[c].pj,GetObjById(e).readOnly=!0;GetObjById("tuiyou").options.length=0,GetObjById("tuiyou").options[0]=new Option(a.TYBM),GetObjById("submit").value="确定",GetObjById("save").remove(),GetObjById("submit").onclick=function(){GetObjById("show_more").innerHTML=""}}}function Show_YXBZPD(){var c,d,e,f,g,a=Get_YXBZPD(),b=new String;for(b+='<h3>评定本月优秀部长</h3>\n<p class="fill_in_tips">请勾选4名你认为本月表现较好的部长级</p>\n<form name="yxbzpdb" id="yxbzpdb" action="#" method="#">\n<table>',c=0;c<a.arrYXBZPDlist.length;c++)d=a.arrYXBZPDlist[c].account,e=a.arrYXBZPDlist[c].name,f=a.arrYXBZPDlist[c].depart,g=a.arrYXBZPDlist[c].score,b+="<tr><td>"+(c+1)+'.</td><td><label for="'+d+'"><input type="checkbox" id="'+d+'" name="'+d+'" value="'+d+'"',1==a.arrYXBZPDlist[c].Checked&&(b+='checked="checked"'),b+="/>"+e+"</label></td><td> <span>&emsp;部门:</span> "+f+"</td><td><span>&emsp;得分:</span> "+g+"</td></tr>";b+="</table>",0==a.status?(b+='<button type="button" name="youxiubuzhan" id="youxiubuzhan" class="perf_button"> 提交\n</button>\n',document.getElementById("show_more").innerHTML=b,document.getElementById("youxiubuzhan").onclick=function(){var b,c,d;for(alert("hehehhehehhe"),b=document.forms["yxbzpdb"],c=new Array,d=0;d<a.arrYXBZPDlist.length;d++)1==b.elements[d].checked&&c.push(b.elements[d].name);if(4>=c.length&&0<c.length){if(1!=Post_YXBZPD(c))return alert("提交失败，请重试！"),!1;alert("提交成功！"),GetObjById("show_more").innerHTML=""}else alert("你勾选的数量非法")}):(b+='<button type="button" name="youxiubuzhan" id="youxiubuzhan" class="perf_button"> 确定\n</button>\n',GetObjById("show_more").innerHTML=b,GetObjById("youxiubuzhan").onclick=function(){GetObjById("show_more").innerHTML=""})}function Show_ZXTFK(){var c,d,a=Get_ZXTFK(year,month),b=new String;for(b+='<p class="fill_int_tips">部门排名情况</p>\n<ol>',c=0;c<a.arrSorted.length;c++)b+="<li>"+arrDepartName[a.arrSorted[c].name-1]+"&emsp;<span>得分：</span>"+a.arrSorted[c].score,1==a.arrSorted[c].isExc&&(b+="<span>&emsp;月度优秀部门</span>"),b+="</li>";for(b+='</ol><p class="fill_in_tips">优秀部长</p>\n<ol>',c=0;c<a.arrExcMin.length;c++)b+="<li><span>月度优秀部长：</span>"+a.arrExcMin[c].name+"&emsp;<span>所属部门：</span>"+arrDepartName[a.arrExcMin[c].depart-1]+"&emsp;<span>得分：</span>"+a.arrExcMin[c].score+"</li>";for(b+='</ol><p class="fill_in_tips">部长级情况反馈</p>\n<ul>',c=0;c<a.arrMinFeedBack.length;c++)b+="<li><span>"+arrDepartName[a.arrMinFeedBack[c].depart-1]+":&emsp;</span>"+a.arrMinFeedBack[c].minister+'<ul><li>自我评价：<br /><p class="self-assessment">'+a.arrMinFeedBack[c].selfAssess+'<p></li><li>对主管副主席的评价：<br /><p class"self-assessment">'+a.arrMinFeedBack[c].feedBack+"</p></li></ul></li>";for(b+='</ul><p class="fill_in_tips">来自其他部长级的匿名评价</p><ul>\n',c=0;c<a.arrAnonymity.length;c++)d=a.arrAnonymity[c].anonymityFeedBack,""!=d&&" "!=d&&"无"!=d&&(b+="<li>"+a.arrAnonymity[c].anonymityFeedBack+"</li>");
b+='</ul><button type="button" id="submit" class="perf_button">确定</button>',GetObjById("show_more").innerHTML=b,GetObjById("submit").onclick=function(){GetObjById("show_more").innerHTML=""}}function Show_KHJCKZ(){var b,a="";a+='<h3>开始本月考核</h3> <p class="fill_in_tips">开始填写：点击后激活本月绩效考核，各项表格除《优秀部长考核表》外可填</p> <button type="button" name="kaishikaohe" id="kaishikaohe" class="perf_button"> 开始本月考核 </button> <hr class="perf_hr" /> <h3>开始优秀部长评定</h3> <p class="fill_in_tips">开始优秀部长评定：点击后关闭干事和部长的所有填写性表格，激活《优秀部长评定表》,激活后，除《优秀部长评定表》外所有表格不可填</p> <button type="button" name="kaishikaohe" id="yxpzpd" class="perf_button"> 开始优秀部长评定 </button> <hr class="perf_hr" /> <h3>发布结果</h3> <p class="fill_in_tips">发布结果：点击后所有反馈表发布，所有可填表关闭，结束本月考核</p> <button type="button" name="kaishikaohe" id="fabujieguo" class="perf_button"> 发布结果 </button> <hr class="perf_hr" /></ul><button type="button" id="submit" class="perf_button">确定</button>',GetObjById("show_more").innerHTML=a,b=Get_KHJCKZ(),GetObjById("kaishikaohe").onclick=function(){0==b.KSKH?confirm("确定开始本月考核?")&&(b.KSKH=1,Post_KHJCKZ(b)?GetObjById("show_more").innerHTML="":alert("确定开始本月考核失败，请重试")):alert("已经开始了本月份的考核")},GetObjById("yxpzpd").onclick=function(){1==b.KSKH&&0==b.KSPD?confirm("确定开始优秀部长评定?")&&(b.KSPD=1,Post_KHJCKZ(b)?GetObjById("show_more").innerHTML="":alert("开始优秀部长评定失败，请重试")):0==b.KSKH?alert("还没进行考核，不能开始优秀部长评定"):alert("已经开始了本月份的优秀部长评定")},GetObjById("fabujieguo").onclick=function(){1==b.KSKH&&1==b.KSPD&&0==b.FBJG?confirm("确定发布结果?")&&(b.FBJG=1,Post_KHJCKZ(b)?GetObjById("show_more").innerHTML="":alert("发布结果失败，请重试")):0==b.KSKH?alert("还没开始考核，不能发布结果"):0==b.KSPD?alert("还没进行优秀部长评定，不能发布结果"):alert("已经发布了本月份的考核结果")},GetObjById("submit").onclick=function(){GetObjById("show_more").innerHTML=""}}function Show_QTQKJJF(){function f(){var b,c,d;for(b=0;b<a.persons.length;++b){if(c="jiajianfen_"+b,d="liyou_"+b,""==GetObjById(c).value)return!1;if(""==GetObjById(d).value)return!1}return""==GetObjById("bmjjf").value?!1:""==GetObjById("liyou").value?!1:!0}var c,d,e,a=Get_QTQKJJF(),b="";for(b+="<h3>跟进部门："+arrDepartName[a.gjbm-1]+"</h3>",b+='<table class="erjibiao">  <tr><td>姓名</td><td>职位</td><td>加减分</td><td>理由</td>',c=0;c<a.persons.length;++c)b+="<tr><td>"+a.persons[c].name+"</td><td>"+a.persons[c].depart+"</td>"+'<td class="normal_input"><input id="'+("jiajianfen_"+c)+'" type="text" size="5" class="perf_textarea" value="'+a.persons[c].jiajianfen+'" /></td>'+'<td class="normal_input"><input id="'+("liyou_"+c)+'" type="texteara" size="80" class="perf_textarea" value="'+a.persons[c].liyou+'" /></td></tr>\n';if(b+="<tr><td>"+arrDepartName[a.bmjjf.name-1]+"</td><td></td>"+'<td class="normal_input"><input id="'+"bmjjf"+'" type="text" size="5" class="perf_textarea" value="'+a.bmjjf.jiajianfen+'" /></td>'+'<td class="normal_input"><input id="'+"liyou"+'" type="texteara" size="80" class="perf_textarea" value="'+a.bmjjf.liyou+'" /></td></tr>\n',b+="</table>",b+='<input type="button" value="提交" id="submit"  class="perf_button" />\n',GetObjById("show_more").innerHTML=b,0==a.status){for(c=0;c<a.persons.length;++c)d="jiajianfen_"+c,e="liyou_"+c,GetObjById(d).onchange=function(b){d=GetId(b);var c=d.split("_");a.persons[c[1]].jiajianfen=this.value},GetObjById(e).onchange=function(b){e=GetId(b);var c=e.split("_");CheckLegalStr(this.value)||(this.value="",alert("您输入有非法字段，请重新输入")),a.persons[c[1]].liyou=this.value};GetObjById("bmjjf").onchange=function(){a.bmjjf.jiajianfen=this.value},GetObjById("liyou").onchange=function(){CheckLegalStr(this.value)||(this.value="",alert("您输入有非法字段，请重新输入")),a.bmjjf.liyou=this.value},GetObjById("submit").onclick=function(){f()?POST_QTQKJJF(a)?(alert("提交成功！"),GetObjById("show_more").innerHTML=""):alert("*提交失败，请再提交"):alert("您还未完成，请填完再提交")}}else{for(c=0;c<a.persons.length;++c)d="jiajianfen_"+c,e="liyou_"+c,GetObjById(d).readOnly=!0,GetObjById(e).readOnly=!0;GetObjById("submit").value="确定",GetObjById("submit").onclick=function(){GetObjById("show_more").innerHTML=""}}}function Show_YXPDXZ(){var c,d,e,f,g,h,i,a=Get_YXPDXZ(),b="<br /><h2>各部门部长和干事优秀评定限制</h2>";for(c=0;c<a.arrDepart.length;++c)for(b+="<h3>"+a.arrDepart[c].depart+"</h3>"+'<label><input type="checkbox" id="'+("quanxuan_"+c)+'" />全选</label><br />',d=0;d<a.arrDepart[c].arrPersons.length;++d)0==d%5&&(b+="<br />"),b+='<label><input type="checkbox" id="'+("xuanze_"+c+"_"+d)+'" />'+a.arrDepart[c].arrPersons[d].name+"</label>",b+="<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>";for(b+="<br /><br /><h2>部门优秀评定限制</h2>",b+='<label><input type="checkbox" id="quanxuan" />全选</label><br />',c=0;c<a.arrBMPD.length;++c)0==c%5&&(b+="<br />"),b+='<label><input type="checkbox" id="'+("xuanze_"+c)+'" />'+a.arrBMPD[c].depart,b+="<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>";if(b+='<br /><input type="button" value="提交" id="submit"  class="perf_button" />\n',GetObjById("show_more").innerHTML=b,0==a.status){for(e=new Array,c=0;c<a.arrDepart.length;++c){for(f=!0,e[c]=0,d=0;d<a.arrDepart[c].arrPersons.length;++d)g="xuanze_"+c+"_"+d,GetObjById(g).checked=a.arrDepart[c].arrPersons[d].check,0==GetObjById(g).checked?f=!1:e[c]++,GetObjById(g).onclick=function(b){g=GetId(b);var c=g.split("_");a.arrDepart[c[1]].arrPersons[c[2]].check=this.checked,0==this.checked?(GetObjById("quanxuan_"+c[1]).checked=!1,e[c[1]]--):(e[c[1]]++,e[c[1]]==a.arrDepart[c[1]].arrPersons.length&&(GetObjById("quanxuan_"+c[1]).checked=!0))};h="quanxuan_"+c,1==f&&(GetObjById(h).checked=!0),GetObjById(h).onclick=function(b){var c,d;for(h=GetId(b),c=h.split("_"),d=0;d<a.arrDepart[c[1]].arrPersons.length;++d)a.arrDepart[c[1]].arrPersons[d].check=this.checked,GetObjById("xuanze_"+c[1]+"_"+d).checked=this.checked}}for(i=0,c=0;c<a.arrBMPD.length;++c)1==a.arrBMPD[c].check&&i++,g="xuanze_"+c,GetObjById(g).checked=a.arrBMPD[c].check,GetObjById(g).onclick=function(b){g=GetId(b);var c=g.split("_");1==this.checked?(i++,a.arrBMPD[c[1]].check=!0,i==a.arrBMPD.length&&(GetObjById("quanxuan").checked=!0)):(i--,GetObjById("quanxuan").checked=!1,a.arrBMPD[c[1]].check=!1)};i==a.arrBMPD.length&&(GetObjById("quanxuan").checked=!0),GetObjById("quanxuan").onclick=function(){for(var b=0;b<a.arrBMPD.length;++b)GetObjById("xuanze_"+b).checked=this.checked,a.arrBMPD[b].check=this.checkde},GetObjById("submit").onclick=function(){Post_YXPDXZ(a)?(alert("提交成功！"),GetObjById("show_more").innerHTML=""):alert("*提交失败，请再提交")}}else{for(c=0;c<a.arrDepart.length;++c){for(f=!0,d=0;d<a.arrDepart[c].arrPersons.length;++d)g="xuanze_"+c+"_"+d,GetObjById(g).checked=a.arrDepart[c].arrPersons[d].check,GetObjById(g).disabled="disabled",0==GetObjById(g).checked&&(f=!1);h="quanxuan_"+c,1==f&&(GetObjById(h).checked=!0),GetObjById(h).disabled="disabled"}for(i=0,c=0;c<a.arrBMPD.length;++c)1==a.arrBMPD[c].check&&i++,g="xuanze_"+c,GetObjById(g).checked=a.arrBMPD[c].check,GetObjById(g).disabled="disabled";i==a.arrBMPD.length&&(GetObjById("quanxuan").checked=!0),GetObjById("quanxuan").disabled="disabled",GetObjById("submit").value="确定",GetObjById("submit").onclick=function(){GetObjById("show_more").innerHTML=""}}}function Show_CKWWCQK(){var c,a=Get_CKWWCQK(),b=new String;for(b+='<h3>干事自评表未填写</h3>\n<p class="fill_in_tips">未填写干事自评表的名单</p>\n<table class="erjibiao" ><tr><td>干事姓名</td><td>部门</td><td>是否有提交记录</td><td>当前是否可提交</td><td>姓名</td><td>部门</td><td>是否有提交记录</td><td>当前是否可提交</td></tr>',c=0;c<a.arrGSZP.length;c++)0==c%2&&(b+='<tr class="ckwwcqk">'),b+="<td>"+a.arrGSZP[c].name+"</td>"+"<td>"+arrDepartName[a.arrGSZP[c].depart-1]+"</td>"+"<td>",b+=1==a.arrGSZP[c].hadSubmit?"提交过":"否",b+="</td><td>",b+=0==a.statusGSZP?"是":"否",b+="</td>",1==c%2&&(b+="</tr>");for(b+='</table><h3>部长自评表未填写</h3><p class="fill_in_tips">未填写部长自评表的名单</p>\n<table class="erjibiao"><tr><td>部长姓名</td><td>部门</td><td>是否有提交记录</td><td>当前是否可提交</td><td>姓名</td><td>部门</td><td>是否有提交记录</td><td>当前是否可提交</td></tr>',c=0;c<a.arrBZZP.length;c++)0==c%2&&(b+='<tr class="ckwwcqk">'),b+="<td>"+a.arrBZZP[c].name+"</td>"+"<td>"+arrDepartName[a.arrBZZP[c].depart-1]+"</td>"+"<td>",b+=1==a.arrBZZP[c].hadSubmit?"提交过":"否",b+="</td><td>",b+=0==a.statusBZZP?"是":"否",b+="</td>",1==c%2&&(b+="</tr>");for(b+='</table><h3>干事考核表未填写</h3><p class="fill_in_tips">未填写干事考核表的名单</p>\n<table class="erjibiao"><tr><td>部长姓名</td><td>部门</td><td>是否有提交记录</td><td>当前是否可提交</td><td>部长姓名</td><td>部门</td><td>是否有提交记录</td><td>当前是否可提交</td></tr>',c=0;c<a.arrGSKH.length;c++)0==c%2&&(b+='<tr class="ckwwcqk">'),b+="<td>"+a.arrGSKH[c].name+"</td>"+"<td>"+arrDepartName[a.arrGSKH[c].depart-1]+"</td>"+"<td>",b+=1==a.arrGSKH[c].hadSubmit?"提交过":"否",b+="</td><td>",b+=0==a.statusGSKH?"是":"否",b+="</td>",1==c%2&&(b+="</tr>");for(b+='</table><h3>部长考核表未填写</h3><p class="fill_in_tips">未填写部长考核表的名单</p><table class="erjibiao"><tr><td>主席姓名</td><td>是否有提交记录</td><td>当前是否可提交</td><td>主席姓名</td><td>是否有提交记录</td><td>当前是否可提交</td></tr>',c=0;c<a.arrBZKH.length;c++)0==c%2&&(b+='<tr class="ckwwcqk">'),b+="<td>"+a.arrBZKH[c].name+"</td>"+"<td>",b+=1==a.arrBZKH[c].hadSubmit?"提交过":"否",b+="</td><td>",b+=0==a.statusBZKH?"是":"否",b+="</td>",1==c%2&&(b+="</tr>");for(b+='</table><h3>部门考核未填写</h3><p class="fill_in_tips">未填写部门考核表的名单</p><table class="erjibiao"><tr><td>主席姓名</td><td>是否有提交记录</td><td>当前是否可提交</td><td>主席姓名</td><td>是否有提交记录</td><td>当前是否可提交</td></tr>',c=0;c<a.arrBMKH.length;c++)0==c%2&&(b+='<tr class="ckwwcqk">'),b+="<td>"+a.arrBMKH[c].name+"</td>"+"<td>",b+=1==a.arrBMKH[c].hadSubmit?"提交过":"否",b+="</td><td>",b+=0==a.statusBMKH?"是":"否",b+="</td>",1==c%2&&(b+="</tr>");b+='</table><input type="button" value="确定" id="submit"  class="perf_button" />\n',GetObjById("show_more").innerHTML=b,GetObjById("submit").onclick=function(){GetObjById("show_more").innerHTML=""}}function Show_WJDJ(a){var b,c;for(alert("show违纪登记"+a),objWJDJ=Get_WJDJ(a),b=new String,c=0;c<objWJDJ.arrWJDJB.length;c++)b+="<h3>"+arrDepartName[objWJDJ.arrWJDJB[c].bm-1]+"</h3>"+'<p class="fill_in_tips"><span class="fill_part">填写指引:</span>'+"请填写"+arrDepartName[objWJDJ.arrWJDJB[c].bm-1]+"的违纪情况,多个理由请用'|'隔开"+"</p>"+"<h4>违纪扣分:</h4>"+'<input id="df_'+objWJDJ.arrWJDJB[c].bm+'" class="perf_textarea" type="text" name="#" size="10" />'+"<h4>理由:</h4>"+'<textarea id="ly_'+objWJDJ.arrWJDJB[c].bm+'" class="perf_textarea" name="#" rows="4" cols="50"></textarea>';for(b+='<br /><input type="button" value="提交" id="submit"  class="perf_button" />\n',$("#show_more").hide().html(b),c=0;c<objWJDJ.arrWJDJB.length;c++)$("#df_"+objWJDJ.arrWJDJB[c].bm).val(objWJDJ.arrWJDJB[c].kf).change(function(){var d,a=$(this).val(),b=-1,c=new String($(this).attr("id"));for(c=c.replace("df_",""),console.log(c),d=0;d<objWJDJ.arrWJDJB.length;d++)if(objWJDJ.arrWJDJB[d].bm==c){b=d;break}0>=a&&a>=-100?objWJDJ.arrWJDJB[d].kf=$(this).val():(alert("您填写的内容含有非法字符,请重新填写"),$(this).val(objWJDJ.arrWJDJB[b].kf),""==$(this).val()&&($(this).val("0"),objWJDJ.arrWJDJB[b].kf="0"))}),$("#ly_"+objWJDJ.arrWJDJB[c].bm).val(objWJDJ.arrWJDJB[c].ly).change(function(){var d,a=$(this).val(),b=-1,c=new String($(this).attr("id"));for(c=c.replace("ly_",""),console.log(c),d=0;d<objWJDJ.arrWJDJB.length;d++)if(objWJDJ.arrWJDJB[d].bm==c){b=d;break}CheckLegalStr(a)?objWJDJ.arrWJDJB[b].ly=$(this).val():(alert("您填写的内容含有非法字符,请重新填写"),$(this).val(objWJDJ.arrWJDJB[b].ly),""==$(this).val()&&($(this).val("null"),objWJDJ.arrWJDJB[b].ly="null"))});0==objWJDJ.status?$("#submit").click(function(){Post_WJDJ(objWJDJ,a)?(alert("提交成功"),$("#show_more").html("")):alert("*提交失败，请重试")}):($("#submit").val("确定").click(function(){$("#show_more").html("")}),$("#show_more input,#show_more textarea").attr("readonly",!0)),$("h4").css("margin","0"),$("#show_more").slideDown()}var year,month,arrDepartName,arrTypeName,arrWeiJiBiao,afxTimeInfo;window.onload=PerformInit,arrDepartName=new Array("秘书处","人力资源部","宣传部","信息编辑部","学术部","体育部","KSC联盟","组织部","文娱部","公关部","心理服务部","主席团"),arrTypeName=new Array("干事","人力干事","部长级","主席团"),arrWeiJiBiao=new Array("秘书处制度违纪登记表","人力资源部制度违纪登记表","宣传部制度违纪登记表","信息编辑部制度违纪登记表","公关部制度违纪登记表","司仪礼仪队违纪登记表");